# ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆæ¯”è¼ƒè³‡æ–™

> **ä½œæˆæ—¥**: 2025å¹´9æœˆ30æ—¥
> **æ›´æ–°æ—¥**: 2025å¹´9æœˆ30æ—¥
> **ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹**: æ¤œè¨ä¸­
> **ç›®çš„**: æœ€é©ãªã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆã®é¸å®š

## ğŸ“‹ ç›®æ¬¡

1. [è¦ä»¶ã®æ•´ç†](#è¦ä»¶ã®æ•´ç†)
2. [æ§‹æˆã‚ªãƒ—ã‚·ãƒ§ãƒ³æ¯”è¼ƒ](#æ§‹æˆã‚ªãƒ—ã‚·ãƒ§ãƒ³æ¯”è¼ƒ)
3. [è©³ç´°æ¯”è¼ƒè¡¨](#è©³ç´°æ¯”è¼ƒè¡¨)
4. [ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ](#ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ)
5. [æ¨å¥¨ãƒ—ãƒ©ãƒ³](#æ¨å¥¨ãƒ—ãƒ©ãƒ³)
6. [å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—](#å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—)

---

## ğŸ¯ è¦ä»¶ã®æ•´ç†

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

| é …ç›®                     | è©³ç´°                     |
| ------------------------ | ------------------------ |
| **åˆ©ç”¨ç¯„å›²**             | ç¤¾å†…å°‚ç”¨ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ |
| **æƒ³å®šãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°**       | 10ã€œ100åç¨‹åº¦            |
| **æ—¢å­˜Webã‚¢ãƒ—ãƒª**        | Lichtblickï¼ˆCaddyä½¿ç”¨ï¼‰  |
| **ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼** | AWS                      |

### å¿…é ˆè¦ä»¶

| è¦ä»¶                     | è©³ç´°                                                      |
| ------------------------ | --------------------------------------------------------- |
| **ã‚¯ãƒ©ã‚¦ãƒ‰ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼** | AWS ã‚’ä½¿ç”¨                                                |
| **ã‚³ã‚¹ãƒˆ**               | ã§ãã‚‹ã ã‘ä½ã‚³ã‚¹ãƒˆã§é‹ç”¨ï¼ˆç¤¾å†…åˆ©ç”¨ã®ãŸã‚æœ€å°é™ï¼‰          |
| **æ‹¡å¼µæ€§**               | åˆæœŸ: ãƒ•ã‚¡ã‚¤ãƒ«ã‚µãƒ¼ãƒãƒ¼ â†’ å°†æ¥: DB + APIå¯¾å¿œ               |
| **å¯ç”¨æ€§**               | Webã‚¢ãƒ—ãƒªãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ä¸­ã‚‚ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹æ©Ÿèƒ½ã¯åˆ©ç”¨å¯èƒ½ |
| **ãƒ‰ãƒ¡ã‚¤ãƒ³**             | Webã‚¢ãƒ—ãƒªã¨åŒã˜ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ä½¿ç”¨                             |
| **ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º**         | æœ¬ç•ªç’°å¢ƒï¼ˆS3 + CloudFrontï¼‰ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§å†ç¾å¯èƒ½           |

### åˆæœŸãƒ•ã‚§ãƒ¼ã‚ºã§é…ä¿¡ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«

```
extensions.json          # æ‹¡å¼µæ©Ÿèƒ½ã‚«ã‚¿ãƒ­ã‚°ï¼ˆæ•°KBï¼‰
extensions/*.foxe        # æ‹¡å¼µæ©Ÿèƒ½ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆæ•°MBã€œæ•°åMB/ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
thumbnails/*.png         # ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒï¼ˆæ•°KBã€œæ•°ç™¾KB/ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰
```

**æƒ³å®šãƒ‡ãƒ¼ã‚¿é‡**ï¼ˆç¤¾å†…åˆ©ç”¨ï¼‰:

- æ‹¡å¼µæ©Ÿèƒ½æ•°: 10ã€œ50å€‹
- ç·ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸: 1ã€œ5GB
- æœˆé–“ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰: 100ã€œ500å›
- åŒæ™‚æ¥ç¶š: 10ã€œ20ãƒ¦ãƒ¼ã‚¶ãƒ¼

### æ—¢å­˜ç’°å¢ƒ

```
æ—¢å­˜Webã‚¢ãƒ—ãƒªï¼ˆLichtblickï¼‰
â”œâ”€ Webã‚µãƒ¼ãƒãƒ¼: Caddy
â”œâ”€ ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚°: AWS EC2 or ä»–
â””â”€ ãƒ‰ãƒ¡ã‚¤ãƒ³: https://yourdomain.com
```

**åˆ¶ç´„äº‹é …**:

- Webã‚¢ãƒ—ãƒªã¨ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹ã¯ç‹¬ç«‹ã—ã¦ç¨¼åƒã™ã‚‹å¿…è¦ãŒã‚ã‚‹
- åŒä¸€ãƒ‰ãƒ¡ã‚¤ãƒ³é…ä¸‹ã§ãƒ‘ã‚¹ãƒ™ãƒ¼ã‚¹ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ï¼ˆä¾‹: `/marketplace/*`ï¼‰

### å°†æ¥çš„ã«è¿½åŠ äºˆå®šã®æ©Ÿèƒ½

- æ‹¡å¼µæ©Ÿèƒ½ã®æ¤œç´¢API
- ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰çµ±è¨ˆ
- é–‹ç™ºè€…å‘ã‘å…¬é–‹ç”³è«‹ãƒ•ãƒ­ãƒ¼
- è‡ªå‹•æ›´æ–°é€šçŸ¥

---

## ğŸ—ï¸ æ§‹æˆã‚ªãƒ—ã‚·ãƒ§ãƒ³æ¯”è¼ƒ

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³1: S3 + CloudFront â­æ¨å¥¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        CloudFront (CDN)                 â”‚
â”‚   https://yourdomain.com                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
        â”‚               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ S3 Bucket      â”‚  â”‚  EC2 or     â”‚
â”‚ (é™çš„ãƒ•ã‚¡ã‚¤ãƒ«) â”‚  â”‚  ä»–ã‚µãƒ¼ãƒãƒ¼ â”‚
â”‚                â”‚  â”‚             â”‚
â”‚ /marketplace/  â”‚  â”‚ Caddy       â”‚
â”‚  extensions.jsonâ”‚  â”‚ (Webã‚¢ãƒ—ãƒª) â”‚
â”‚  extensions/   â”‚  â”‚ /           â”‚
â”‚  thumbnails/   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ç‰¹å¾´

**âœ… ãƒ¡ãƒªãƒƒãƒˆ**

- **è¶…ä½ã‚³ã‚¹ãƒˆ**: ç¤¾å†…åˆ©ç”¨ï¼ˆå°è¦æ¨¡ï¼‰ãªã‚‰æœˆé¡ **$0.50ã€œ1.00** ç¨‹åº¦
- **å®Œå…¨ãªç‹¬ç«‹æ€§**: Webã‚¢ãƒ—ãƒªï¼ˆCaddyï¼‰ã®ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ»ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã«å½±éŸ¿ã•ã‚Œãªã„
- **è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°**: ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯å¢—åŠ ã«è‡ªå‹•å¯¾å¿œï¼ˆç¤¾å†…åˆ©ç”¨ã§ã¯ä¸è¦ã ãŒå°†æ¥ã®ä¿é™ºï¼‰
- **ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ä¸è¦**: ã‚µãƒ¼ãƒãƒ¼ç®¡ç†ãŒä¸€åˆ‡ä¸è¦
- **é«˜å¯ç”¨æ€§**: 99.99%ã®SLAä¿è¨¼
- **ã‚°ãƒ­ãƒ¼ãƒãƒ«é…ä¿¡**: CloudFrontã®ã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§é«˜é€Ÿé…ä¿¡ï¼ˆç¤¾å†…ã§ã‚‚åŠ¹æœã‚ã‚Šï¼‰

**âŒ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ**

- å‹•çš„å‡¦ç†ã«ã¯åˆ¥é€”Lambdaç­‰ãŒå¿…è¦ï¼ˆå°†æ¥å¯¾å¿œå¯èƒ½ï¼‰

#### ã‚³ã‚¹ãƒˆè©³ç´°ï¼ˆç¤¾å†…åˆ©ç”¨æƒ³å®šï¼‰

| é …ç›®                      | æœˆé–“ä½¿ç”¨é‡ï¼ˆæƒ³å®šï¼‰ | æ–™é‡‘            |
| ------------------------- | ------------------ | --------------- |
| **S3 ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸**         | 5GB                | $0.12           |
| **S3 ãƒªã‚¯ã‚¨ã‚¹ãƒˆ**         | 1,000 GET          | $0.0004         |
| **CloudFront è»¢é€**       | 5GB                | $0.43           |
| **CloudFront ãƒªã‚¯ã‚¨ã‚¹ãƒˆ** | 1,000              | ç„¡æ–™æ å†…        |
| **åˆè¨ˆ**                  | -                  | **ç´„ $0.55/æœˆ** |

â€» 50ãƒ¦ãƒ¼ã‚¶ãƒ¼ã€æœˆé–“500ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰æƒ³å®šï¼ˆç¤¾å†…åˆ©ç”¨ï¼‰

---

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³2: EC2 å˜ä¸€ã‚µãƒ¼ãƒãƒ¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        CloudFront (CDN)                 â”‚
â”‚           ã‚ªãƒ—ã‚·ãƒ§ãƒ³                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   EC2 Instanceâ”‚
        â”‚   t3.micro    â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚  Nginx        â”‚ â† ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ /marketplace  â”‚
        â”‚  Caddy/Docker â”‚ â† ãƒ•ã‚¡ã‚¤ãƒ«ã‚µãƒ¼ãƒãƒ¼
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
        â”‚ /app          â”‚
        â”‚  Node.jsç­‰    â”‚ â† Webã‚¢ãƒ—ãƒª
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ç‰¹å¾´

**âœ… ãƒ¡ãƒªãƒƒãƒˆ**

- ã‚·ãƒ³ãƒ—ãƒ«ãªæ§‹æˆ
- å…¨ã¦ãŒ1ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã§å®Œçµ
- åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒæ¯”è¼ƒçš„å®¹æ˜“

**âŒ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ**

- **Webã‚¢ãƒ—ãƒªã®ãƒ‡ãƒ—ãƒ­ã‚¤æ™‚ã«å½±éŸ¿ã‚’å—ã‘ã‚‹å¯èƒ½æ€§**
- EC2åœæ­¢ = ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹ã‚‚åœæ­¢
- æ‰‹å‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°ã®ã¿
- ã‚µãƒ¼ãƒãƒ¼ç®¡ç†ãŒå¿…è¦ï¼ˆã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ‘ãƒƒãƒç­‰ï¼‰
- ã‚³ã‚¹ãƒˆãŒé«˜ã‚

#### ã‚³ã‚¹ãƒˆè©³ç´°

| é …ç›®             | æœˆé–“ä½¿ç”¨é‡          | æ–™é‡‘             |
| ---------------- | ------------------- | ---------------- |
| **EC2 t3.micro** | 730æ™‚é–“ï¼ˆå¸¸æ™‚ç¨¼åƒï¼‰ | $7.59            |
| **EBS 20GB**     | 20GB                | $2.00            |
| **ãƒ‡ãƒ¼ã‚¿è»¢é€**   | 5GBï¼ˆç¤¾å†…ï¼‰         | $0.45            |
| **åˆè¨ˆ**         | -                   | **ç´„ $10.04/æœˆ** |

**æ³¨**: ç¤¾å†…åˆ©ç”¨ã§ã‚‚EC2ã®å›ºå®šè²»ã¯å¤‰ã‚ã‚‰ãªã„ãŸã‚ã€S3+CloudFrontã¨æ¯”è¼ƒã—ã¦ã‚³ã‚¹ãƒˆåŠ¹ç‡ãŒæ‚ªã„

---

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³3: EC2 Ã— 2å°ï¼ˆåˆ†é›¢æ§‹æˆï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Application Load Balancer            â”‚
â”‚         or CloudFront                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
        â”‚               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ EC2 Instance   â”‚  â”‚ EC2 Instanceâ”‚
â”‚ (Webã‚¢ãƒ—ãƒª)    â”‚  â”‚ (ãƒ•ã‚¡ã‚¤ãƒ«   â”‚
â”‚                â”‚  â”‚  ã‚µãƒ¼ãƒãƒ¼)  â”‚
â”‚ Node.jsç­‰      â”‚  â”‚ Caddy/Nginx â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ç‰¹å¾´

**âœ… ãƒ¡ãƒªãƒƒãƒˆ**

- Webã‚¢ãƒ—ãƒªã¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚µãƒ¼ãƒãƒ¼ãŒå®Œå…¨ã«ç‹¬ç«‹
- ãã‚Œãã‚Œå€‹åˆ¥ã«ã‚¹ã‚±ãƒ¼ãƒ«ãƒ»ç®¡ç†å¯èƒ½

**âŒ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ**

- **ã‚³ã‚¹ãƒˆãŒé«˜ã„**ï¼ˆEC2 Ã— 2ï¼‰
- ç®¡ç†å¯¾è±¡ãŒ2å€
- ãƒ•ã‚¡ã‚¤ãƒ«é…ä¿¡ã ã‘ã«EC2ã‚’ä½¿ã†ã®ã¯ã‚ªãƒ¼ãƒãƒ¼ã‚¹ãƒšãƒƒã‚¯

#### ã‚³ã‚¹ãƒˆè©³ç´°

| é …ç›®                 | æœˆé–“ä½¿ç”¨é‡ | æ–™é‡‘             |
| -------------------- | ---------- | ---------------- |
| **EC2 t3.micro Ã— 2** | 1,460æ™‚é–“  | $15.18           |
| **EBS 20GB Ã— 2**     | 40GB       | $4.00            |
| **ALB**              | 730æ™‚é–“    | $16.20           |
| **ãƒ‡ãƒ¼ã‚¿è»¢é€**       | 10GB       | $0.90            |
| **åˆè¨ˆ**             | -          | **ç´„ $36.28/æœˆ** |

---

### ã‚ªãƒ—ã‚·ãƒ§ãƒ³4: S3 + API Gateway + Lambda

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        CloudFront (CDN)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
        â”‚               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ S3 Bucket      â”‚  â”‚ API Gateway     â”‚
â”‚ (é™çš„ãƒ•ã‚¡ã‚¤ãƒ«) â”‚  â”‚ + Lambda        â”‚
â”‚                â”‚  â”‚ (å‹•çš„API)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                 â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                 â”‚  DynamoDB  â”‚
                 â”‚  or RDS    â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ç‰¹å¾´

**âœ… ãƒ¡ãƒªãƒƒãƒˆ**

- å®Œå…¨ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹
- å¾“é‡èª²é‡‘ï¼ˆä½¿ã£ãŸåˆ†ã ã‘ï¼‰
- è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
- ã‚µãƒ¼ãƒãƒ¼ç®¡ç†ä¸è¦

**âŒ ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ**

- åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãŒã‚„ã‚„è¤‡é›‘
- Lambda/API Gatewayã®å­¦ç¿’ã‚³ã‚¹ãƒˆ

#### ã‚³ã‚¹ãƒˆè©³ç´°ï¼ˆä½ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯æƒ³å®šï¼‰

| é …ç›®            | æœˆé–“ä½¿ç”¨é‡      | æ–™é‡‘            |
| --------------- | --------------- | --------------- |
| **S3**          | åŒä¸Š            | $0.55           |
| **API Gateway** | 1,000ãƒªã‚¯ã‚¨ã‚¹ãƒˆ | ç„¡æ–™æ å†…        |
| **Lambda**      | 1,000å®Ÿè¡Œ       | ç„¡æ–™æ å†…        |
| **DynamoDB**    | ç„¡æ–™æ           | $0              |
| **åˆè¨ˆ**        | -               | **ç´„ $0.55/æœˆ** |

â€» ç„¡æ–™æ : Lambda 100ä¸‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/æœˆã€API Gateway 100ä¸‡ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/æœˆ
â€» ç¤¾å†…åˆ©ç”¨ï¼ˆä½ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ï¼‰ã§ã¯ç„¡æ–™æ å†…ã§åã¾ã‚‹å¯èƒ½æ€§ãŒé«˜ã„

---

## ğŸ–¥ï¸ ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ

### CloudFront + S3 æ§‹æˆã®ãƒ­ãƒ¼ã‚«ãƒ«å†ç¾

æœ¬ç•ªç’°å¢ƒï¼ˆS3 + CloudFrontï¼‰ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§å†ç¾ã™ã‚‹æ–¹æ³•ã‚’æä¾›ã—ã¾ã™ã€‚

#### æ–¹æ³•1: MinIO + Caddyï¼ˆæ¨å¥¨ï¼‰

**æ§‹æˆ**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Caddy (localhost:3000)      â”‚ â† ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ï¼ˆCloudFrontç›¸å½“ï¼‰
â”‚  â”œâ”€ /marketplace/* â†’ MinIO   â”‚
â”‚  â””â”€ /* â†’ Lichtblick App      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  MinIO (localhost:9000)      â”‚ â† S3äº’æ›ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
â”‚  â””â”€ bucket: marketplace-dev  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Lichtblick App              â”‚ â† æ—¢å­˜Webã‚¢ãƒ—ãƒª
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**MinIOã¨ã¯**:

- S3äº’æ›ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
- Dockerã§ç°¡å˜ã«èµ·å‹•
- AWS SDKãŒãã®ã¾ã¾ä½¿ãˆã‚‹

**Docker Compose è¨­å®šä¾‹**:

```yaml
# docker-compose.yml
version: "3.8"

services:
  # S3äº’æ›ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ï¼ˆMinIOï¼‰
  minio:
    image: minio/minio:latest
    command: server /data --console-address ":9001"
    ports:
      - "9000:9000" # S3 API
      - "9001:9001" # Web UI
    environment:
      MINIO_ROOT_USER: minioadmin
      MINIO_ROOT_PASSWORD: minioadmin
    volumes:
      - ./minio-data:/data
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:9000/minio/health/live"]
      interval: 30s
      timeout: 20s
      retries: 3

  # ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·ï¼ˆCaddyï¼‰
  caddy:
    image: caddy:latest
    ports:
      - "3000:3000"
    volumes:
      - ./Caddyfile:/etc/caddy/Caddyfile
      - ./caddy-data:/data
    depends_on:
      - minio

  # Lichtblick Webã‚¢ãƒ—ãƒªï¼ˆæ—¢å­˜ï¼‰
  lichtblick:
    # æ—¢å­˜ã®è¨­å®š
    ports:
      - "8080:8080"
```

**Caddyfile è¨­å®šä¾‹**:

```caddyfile
# Caddyfile
:3000 {
    # ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹ãƒ•ã‚¡ã‚¤ãƒ« â†’ MinIO
    handle /marketplace/* {
        reverse_proxy minio:9000 {
            header_up Host {host}
            header_up X-Real-IP {remote}
        }
    }

    # Webã‚¢ãƒ—ãƒª â†’ Lichtblick
    handle /* {
        reverse_proxy lichtblick:8080
    }
}
```

**åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¹ã‚¯ãƒªãƒ—ãƒˆ**:

```bash
#!/bin/bash
# setup-local-marketplace.sh

# MinIOã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
brew install minio/stable/mc  # macOS
# ã¾ãŸã¯
# curl -O https://dl.min.io/client/mc/release/linux-amd64/mc

# MinIOã‚¨ã‚¤ãƒªã‚¢ã‚¹è¨­å®š
mc alias set local http://localhost:9000 minioadmin minioadmin

# ãƒã‚±ãƒƒãƒˆä½œæˆ
mc mb local/marketplace-dev

# å…¬é–‹è¨­å®š
mc anonymous set download local/marketplace-dev

# ã‚µãƒ³ãƒ—ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
mc cp ./marketplace-data/extensions.json local/marketplace-dev/
mc cp -r ./marketplace-data/extensions/ local/marketplace-dev/
mc cp -r ./marketplace-data/thumbnails/ local/marketplace-dev/

echo "ãƒ­ãƒ¼ã‚«ãƒ«ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹èµ·å‹•å®Œäº†ï¼"
echo "ã‚¢ã‚¯ã‚»ã‚¹: http://localhost:3000/marketplace/extensions.json"
```

**èµ·å‹•ã‚³ãƒãƒ³ãƒ‰**:

```bash
# èµ·å‹•
docker-compose up -d

# åˆæœŸã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
./setup-local-marketplace.sh

# ã‚¢ã‚¯ã‚»ã‚¹ç¢ºèª
curl http://localhost:3000/marketplace/extensions.json

# MinIO Web UI
open http://localhost:9001  # minioadmin / minioadmin
```

---

#### æ–¹æ³•2: ã‚·ãƒ³ãƒ—ãƒ«ãªCaddyé™çš„ãƒ•ã‚¡ã‚¤ãƒ«ã‚µãƒ¼ãƒãƒ¼

æœ¬ç•ªç’°å¢ƒã‚’å†ç¾ã›ãšã€ã‚·ãƒ³ãƒ—ãƒ«ã«ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«é…ä¿¡ã®ã¿è¡Œã†å ´åˆ:

**Caddyfileï¼ˆã‚·ãƒ³ãƒ—ãƒ«ç‰ˆï¼‰**:

```caddyfile
# Caddyfile.local
:3000 {
    # ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«
    handle /marketplace/* {
        root * /path/to/marketplace-data
        file_server browse
    }

    # Webã‚¢ãƒ—ãƒª
    handle /* {
        reverse_proxy lichtblick:8080
    }
}
```

**èµ·å‹•**:

```bash
# Caddyå˜ä½“èµ·å‹•
caddy run --config Caddyfile.local
```

---

#### æ–¹æ³•3: LocalStackï¼ˆAWSå®Œå…¨ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼‰

ã‚ˆã‚Šæœ¬ç•ªã«è¿‘ã„ç’°å¢ƒãŒå¿…è¦ãªå ´åˆ:

```yaml
# docker-compose.localstack.yml
services:
  localstack:
    image: localstack/localstack:latest
    ports:
      - "4566:4566" # AWS API
    environment:
      SERVICES: s3,cloudfront
      DEBUG: 1
    volumes:
      - ./localstack-data:/tmp/localstack
```

---

### ãƒ­ãƒ¼ã‚«ãƒ«ãƒ»æœ¬ç•ªç’°å¢ƒã®åˆ‡ã‚Šæ›¿ãˆ

**ç’°å¢ƒå¤‰æ•°ã§åˆ‡ã‚Šæ›¿ãˆ**:

```typescript
// packages/suite-base/src/context/ExtensionCatalogContext.tsx

const MARKETPLACE_BASE_URL =
  process.env.NODE_ENV === "development"
    ? "http://localhost:3000/marketplace" // ãƒ­ãƒ¼ã‚«ãƒ«: MinIO + Caddy
    : "https://yourdomain.com/marketplace"; // æœ¬ç•ª: CloudFront + S3

const EXTENSIONS_JSON_URL = `${MARKETPLACE_BASE_URL}/extensions.json`;
```

**`.env.development`**:

```bash
MARKETPLACE_BASE_URL=http://localhost:3000/marketplace
```

**`.env.production`**:

```bash
MARKETPLACE_BASE_URL=https://yourdomain.com/marketplace
```

---

### ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã®ãƒ¡ãƒªãƒƒãƒˆ

| ãƒ¡ãƒªãƒƒãƒˆ               | èª¬æ˜                          |
| ---------------------- | ----------------------------- |
| **æœ¬ç•ªåŒç­‰ã®å‹•ä½œç¢ºèª** | S3äº’æ›ã®MinIOã§æœ¬ç•ªç’°å¢ƒã‚’å†ç¾ |
| **ã‚ªãƒ•ãƒ©ã‚¤ãƒ³é–‹ç™º**     | ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šä¸è¦        |
| **é«˜é€Ÿã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³** | ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ãŒã™ãã«åæ˜       |
| **ã‚³ã‚¹ãƒˆå‰Šæ¸›**         | AWSèª²é‡‘ãªã—                   |
| **ãƒãƒ¼ãƒ å…±æœ‰**         | docker-composeã§ç’°å¢ƒçµ±ä¸€      |

---

## ğŸ“Š è©³ç´°æ¯”è¼ƒè¡¨

| è©•ä¾¡é …ç›®               | S3 + CloudFront     | EC2 å˜ä¸€              | EC2 Ã— 2               | S3 + Lambda         |
| ---------------------- | ------------------- | --------------------- | --------------------- | ------------------- |
| **åˆæœŸã‚³ã‚¹ãƒˆï¼ˆç¤¾å†…ï¼‰** | â­â­â­â­â­ $0.5-1   | â­â­ $10              | â­ $36                | â­â­â­â­â­ $0.5-1   |
| **é‹ç”¨ã‚³ã‚¹ãƒˆ**         | â­â­â­â­â­ å¾“é‡èª²é‡‘ | â­â­ å›ºå®šè²»           | â­ å›ºå®šè²»é«˜           | â­â­â­â­â­ å¾“é‡èª²é‡‘ |
| **ç‹¬ç«‹æ€§**             | â­â­â­â­â­ å®Œå…¨ç‹¬ç«‹ | â­ åŒå±…               | â­â­â­â­â­ å®Œå…¨åˆ†é›¢   | â­â­â­â­â­ å®Œå…¨ç‹¬ç«‹ |
| **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**   | â­â­â­â­â­ è‡ªå‹•     | â­â­ æ‰‹å‹•             | â­â­â­ æ‰‹å‹•           | â­â­â­â­â­ è‡ªå‹•     |
| **ç®¡ç†è² æ‹…**           | â­â­â­â­â­ ãªã—     | â­â­â­ ä¸­             | â­â­ é«˜               | â­â­â­â­ ä½         |
| **ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—**       | â­â­â­â­ ç°¡å˜       | â­â­â­â­â­ ç°¡å˜       | â­â­â­ æ™®é€š           | â­â­â­ ã‚„ã‚„è¤‡é›‘     |
| **æ‹¡å¼µæ€§**             | â­â­â­â­â­ é«˜       | â­â­ ä½               | â­â­â­ ä¸­             | â­â­â­â­â­ é«˜       |
| **å¯ç”¨æ€§**             | â­â­â­â­â­ 99.99%   | â­â­â­ è¦å¯¾ç­–         | â­â­â­â­ è¦å†—é•·åŒ–     | â­â­â­â­â­ 99.95%   |
| **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**     | â­â­â­â­â­ CDN      | â­â­â­ å˜ä¸€ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ | â­â­â­ å˜ä¸€ãƒªãƒ¼ã‚¸ãƒ§ãƒ³ | â­â­â­â­â­ CDN      |
| **ãƒ­ãƒ¼ã‚«ãƒ«å†ç¾**       | â­â­â­â­â­ MinIO    | â­â­â­â­â­ ãã®ã¾ã¾   | â­â­â­ è¤‡é›‘           | â­â­â­â­ LocalStack |

### è©•ä¾¡åŸºæº–

- â­â­â­â­â­ å„ªç§€
- â­â­â­â­ è‰¯å¥½
- â­â­â­ æ™®é€š
- â­â­ ã‚„ã‚„èª²é¡Œã‚ã‚Š
- â­ èª²é¡Œã‚ã‚Š

---

## ğŸ¯ æ¨å¥¨ãƒ—ãƒ©ãƒ³: S3 + CloudFront

### æ¨å¥¨ç†ç”±ï¼ˆç¤¾å†…åˆ©ç”¨ã®å ´åˆï¼‰

#### 1. ã‚³ã‚¹ãƒˆåŠ¹ç‡ ğŸ’°

- **åˆæœŸ**: æœˆé¡ $0.50ã€œ1.00ï¼ˆEC2ã®1/10ä»¥ä¸‹ï¼‰
- **ã‚¹ã‚±ãƒ¼ãƒ«æ™‚**: å¾“é‡èª²é‡‘ã§ç„¡é§„ãªã—ï¼ˆç¤¾å†…åˆ©ç”¨ã§ã¯å¤§ããªã‚¹ã‚±ãƒ¼ãƒ«ã¯ä¸è¦ï¼‰
- **ç„¡æ–™æ **: CloudFront 1TB/å¹´ã¾ã§ç„¡æ–™ï¼ˆç¤¾å†…åˆ©ç”¨ã§ã¯ååˆ†ï¼‰

**ç¤¾å†…åˆ©ç”¨ã§ã®å®Ÿè³ªã‚³ã‚¹ãƒˆ**:

```
50ãƒ¦ãƒ¼ã‚¶ãƒ¼ Ã— æœˆ10ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ = 500ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰/æœˆ
â†’ ãƒ‡ãƒ¼ã‚¿è»¢é€: ç´„5GB/æœˆ
â†’ æœˆé¡ã‚³ã‚¹ãƒˆ: $0.50ã€œ1.00

EC2ã®å ´åˆ:
â†’ å›ºå®šè²»: $10/æœˆï¼ˆãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ã«é–¢ã‚ã‚‰ãšï¼‰
â†’ å·®é¡: å¹´é–“ ç´„$108 ã®ç¯€ç´„
```

#### 2. è¦ä»¶é©åˆåº¦ âœ…

| è¦ä»¶                     | å¯¾å¿œçŠ¶æ³                   |
| ------------------------ | -------------------------- |
| ä½ã‚³ã‚¹ãƒˆï¼ˆç¤¾å†…ï¼‰         | âœ… æœ€å®‰å€¤ï¼ˆ$0.5-1/æœˆï¼‰     |
| Webã‚¢ãƒ—ãƒªï¼ˆCaddyï¼‰ã¨ç‹¬ç«‹ | âœ… å®Œå…¨ç‹¬ç«‹                |
| æ‹¡å¼µæ€§                   | âœ… Lambdaè¿½åŠ ã§å¯¾å¿œå¯      |
| ç®¡ç†è² æ‹…                 | âœ… ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹            |
| åŒä¸€ãƒ‰ãƒ¡ã‚¤ãƒ³             | âœ… CloudFrontã§å®Ÿç¾        |
| ãƒ­ãƒ¼ã‚«ãƒ«å†ç¾             | âœ… MinIO + Caddyã§å®Œå…¨å†ç¾ |

#### 3. æŠ€è¡“çš„ãƒ¡ãƒªãƒƒãƒˆ ğŸš€

```
âœ… è‡ªå‹•ã‚¹ã‚±ãƒ¼ãƒªãƒ³ã‚°
   â†’ ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯å¢—åŠ ã«è‡ªå‹•å¯¾å¿œ

âœ… ã‚°ãƒ­ãƒ¼ãƒãƒ«é…ä¿¡
   â†’ CloudFrontã®200+ã‚¨ãƒƒã‚¸ãƒ­ã‚±ãƒ¼ã‚·ãƒ§ãƒ³

âœ… ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
   â†’ AWS WAFçµ±åˆå¯èƒ½
   â†’ DDoSä¿è­·ï¼ˆAWS Shieldï¼‰

âœ… ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°
   â†’ S3ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ‹ãƒ³ã‚°æ©Ÿèƒ½ã§éå»ç‰ˆç®¡ç†

âœ… ç›£è¦–ãƒ»ãƒ­ã‚®ãƒ³ã‚°
   â†’ CloudWatchçµ±åˆ
   â†’ ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚°è‡ªå‹•è¨˜éŒ²
```

---

## ğŸ—ºï¸ å®Ÿè£…ãƒ­ãƒ¼ãƒ‰ãƒãƒƒãƒ—

### Phase 1: åŸºæœ¬ãƒ•ã‚¡ã‚¤ãƒ«ã‚µãƒ¼ãƒãƒ¼ï¼ˆWeek 1-2ï¼‰

```
ç›®æ¨™: é™çš„ãƒ•ã‚¡ã‚¤ãƒ«é…ä¿¡ã®å®Ÿç¾

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CloudFront     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”
    â”‚   S3    â”‚
    â”‚  Bucket â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®Ÿè£…ã‚¿ã‚¹ã‚¯**:

1. **S3ãƒã‚±ãƒƒãƒˆä½œæˆ** (1æ™‚é–“)

   ```bash
   # ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ç”¨
   aws s3 mb s3://lichtblick-marketplace-prod

   # ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°ç”¨
   aws s3 mb s3://lichtblick-marketplace-staging
   ```

2. **ãƒã‚±ãƒƒãƒˆãƒãƒªã‚·ãƒ¼è¨­å®š** (30åˆ†)

   - ãƒ‘ãƒ–ãƒªãƒƒã‚¯èª­ã¿å–ã‚Šè¨±å¯
   - CORSè¨­å®š

3. **extensions.jsonä½œæˆ** (2æ™‚é–“)

   - ãƒãƒ«ãƒãƒãƒ¼ã‚¸ãƒ§ãƒ³å¯¾å¿œã‚¹ã‚­ãƒ¼ãƒ
   - ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿

4. **CloudFrontè¨­å®š** (2æ™‚é–“)

   - ãƒ‡ã‚£ã‚¹ãƒˆãƒªãƒ“ãƒ¥ãƒ¼ã‚·ãƒ§ãƒ³ä½œæˆ
   - ã‚«ã‚¹ã‚¿ãƒ ãƒ‰ãƒ¡ã‚¤ãƒ³è¨­å®š
   - SSLè¨¼æ˜æ›¸ï¼ˆACMï¼‰

5. **ãƒ‘ã‚¹ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­å®š** (1æ™‚é–“)

   ```
   /marketplace/*  â†’ CloudFront â†’ S3
   /*              â†’ Vercel/EC2ï¼ˆWebã‚¢ãƒ—ãƒªï¼‰
   ```

6. **CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³** (3æ™‚é–“)
   - GitHub Actions
   - S3è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
   - CloudFrontã‚­ãƒ£ãƒƒã‚·ãƒ¥ç„¡åŠ¹åŒ–

**æˆæœç‰©**:

- âœ… ç¨¼åƒä¸­ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚µãƒ¼ãƒãƒ¼
- âœ… `https://yourdomain.com/marketplace/extensions.json`ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½

---

### Phase 2: APIè¿½åŠ ï¼ˆå°†æ¥ãƒ»Week 3-4ï¼‰

```
ç›®æ¨™: å‹•çš„APIæ©Ÿèƒ½ã®è¿½åŠ 

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CloudFront     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
    â”‚           â”‚
â”Œâ”€â”€â”€â–¼â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  S3   â”‚  â”‚API Gateway  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  + Lambda   â”‚
           â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
         â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
         â”‚ DynamoDB   â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®Ÿè£…ã‚¿ã‚¹ã‚¯**:

1. **DynamoDBè¨­è¨ˆ** (2æ™‚é–“)

   - æ‹¡å¼µæ©Ÿèƒ½ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿
   - ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰çµ±è¨ˆ

2. **Lambdaé–¢æ•°ä½œæˆ** (4æ™‚é–“)

   - æ¤œç´¢API
   - çµ±è¨ˆå–å¾—API

3. **API Gatewayè¨­å®š** (2æ™‚é–“)

   - ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆå®šç¾©
   - Lambdaçµ±åˆ

4. **CloudFrontãƒ‘ã‚¹è¿½åŠ ** (1æ™‚é–“)
   ```
   /marketplace/files/*  â†’ S3
   /marketplace/api/*    â†’ API Gateway
   ```

**æˆæœç‰©**:

- âœ… æ¤œç´¢API
- âœ… ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰çµ±è¨ˆAPI

---

### Phase 3: é«˜åº¦ãªæ©Ÿèƒ½ï¼ˆæ¬¡ã€…å›ãƒªãƒªãƒ¼ã‚¹ï¼‰

**è¿½åŠ æ©Ÿèƒ½**:

- é–‹ç™ºè€…ãƒãƒ¼ã‚¿ãƒ«
- æ‹¡å¼µæ©Ÿèƒ½ã®å…¬é–‹ç”³è«‹ãƒ•ãƒ­ãƒ¼
- ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»è©•ä¾¡ã‚·ã‚¹ãƒ†ãƒ 
- è‡ªå‹•æ›´æ–°é€šçŸ¥

---

## ğŸ“ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è©³ç´°å›³

### Phase 1 å®Œæˆå½¢

```
                    ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆ
                         â”‚
                         â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Route 53 (DNS)               â”‚
        â”‚   yourdomain.com               â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   CloudFront Distribution      â”‚
        â”‚   - SSL/TLS (ACMè¨¼æ˜æ›¸)        â”‚
        â”‚   - Gzipåœ§ç¸®                   â”‚
        â”‚   - ã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®š             â”‚
        â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚              â”‚
    Path: /marketplace/*    Path: /*
               â”‚              â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  S3 Bucket  â”‚  â”‚  Vercel or   â”‚
        â”‚  (Origin 1) â”‚  â”‚  EC2         â”‚
        â”‚             â”‚  â”‚  (Origin 2)  â”‚
        â”‚  /extensionsâ”‚  â”‚  Webã‚¢ãƒ—ãƒª   â”‚
        â”‚    .json    â”‚  â”‚              â”‚
        â”‚  /extensionsâ”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚    /*.foxe  â”‚
        â”‚  /thumbnailsâ”‚
        â”‚    /*.png   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 

```
S3ãƒã‚±ãƒƒãƒˆ: lichtblick-marketplace-prod/
â”œâ”€â”€ extensions.json               # ãƒã‚¹ã‚¿ãƒ¼ã‚«ã‚¿ãƒ­ã‚°
â”œâ”€â”€ extensions/
â”‚   â”œâ”€â”€ publisher.ext-name-1.0.0.foxe
â”‚   â”œâ”€â”€ publisher.ext-name-1.1.0.foxe
â”‚   â”œâ”€â”€ publisher.ext-name-2.0.0.foxe
â”‚   â””â”€â”€ ...
â”œâ”€â”€ thumbnails/
â”‚   â”œâ”€â”€ publisher.ext-name.png
â”‚   â””â”€â”€ ...
â””â”€â”€ metadata/                     # å°†æ¥çš„ã«ä½¿ç”¨
    â”œâ”€â”€ stats.json
    â””â”€â”€ ...
```

---

## ğŸ’» å®Ÿè£…ã‚³ãƒ¼ãƒ‰ä¾‹

### 1. S3ãƒã‚±ãƒƒãƒˆä½œæˆï¼ˆTerraformï¼‰

```hcl
# terraform/s3.tf

resource "aws_s3_bucket" "marketplace" {
  bucket = "lichtblick-marketplace-${var.environment}"

  tags = {
    Name        = "Lichtblick Marketplace"
    Environment = var.environment
  }
}

resource "aws_s3_bucket_public_access_block" "marketplace" {
  bucket = aws_s3_bucket.marketplace.id

  block_public_acls       = false
  block_public_policy     = false
  ignore_public_acls      = false
  restrict_public_buckets = false
}

resource "aws_s3_bucket_policy" "marketplace" {
  bucket = aws_s3_bucket.marketplace.id

  policy = jsonencode({
    Version = "2012-10-17"
    Statement = [
      {
        Sid       = "PublicReadGetObject"
        Effect    = "Allow"
        Principal = "*"
        Action    = "s3:GetObject"
        Resource  = "${aws_s3_bucket.marketplace.arn}/*"
      }
    ]
  })
}

resource "aws_s3_bucket_cors_configuration" "marketplace" {
  bucket = aws_s3_bucket.marketplace.id

  cors_rule {
    allowed_headers = ["*"]
    allowed_methods = ["GET", "HEAD"]
    allowed_origins = ["https://yourdomain.com"]
    max_age_seconds = 3600
  }
}
```

### 2. CloudFrontè¨­å®šï¼ˆTerraformï¼‰

```hcl
# terraform/cloudfront.tf

resource "aws_cloudfront_distribution" "marketplace" {
  enabled             = true
  is_ipv6_enabled     = true
  comment             = "Lichtblick Marketplace CDN"
  default_root_object = "extensions.json"

  origin {
    domain_name = aws_s3_bucket.marketplace.bucket_regional_domain_name
    origin_id   = "S3-marketplace"

    s3_origin_config {
      origin_access_identity = aws_cloudfront_origin_access_identity.marketplace.cloudfront_access_identity_path
    }
  }

  default_cache_behavior {
    allowed_methods  = ["GET", "HEAD", "OPTIONS"]
    cached_methods   = ["GET", "HEAD"]
    target_origin_id = "S3-marketplace"

    forwarded_values {
      query_string = false
      cookies {
        forward = "none"
      }
    }

    viewer_protocol_policy = "redirect-to-https"
    min_ttl                = 0
    default_ttl            = 3600
    max_ttl                = 86400
    compress               = true
  }

  restrictions {
    geo_restriction {
      restriction_type = "none"
    }
  }

  viewer_certificate {
    acm_certificate_arn      = var.acm_certificate_arn
    ssl_support_method       = "sni-only"
    minimum_protocol_version = "TLSv1.2_2021"
  }

  aliases = ["marketplace.yourdomain.com"]
}
```

### 3. GitHub Actions ãƒ‡ãƒ—ãƒ­ã‚¤

```yaml
# .github/workflows/deploy-marketplace.yml

name: Deploy Marketplace Files

on:
  push:
    branches: [main]
    paths:
      - "marketplace-data/**"

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3

      - name: Configure AWS credentials
        uses: aws-actions/configure-aws-credentials@v2
        with:
          aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}
          aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}
          aws-region: us-east-1

      - name: Sync to S3
        run: |
          aws s3 sync ./marketplace-data/ s3://lichtblick-marketplace-prod/ \
            --delete \
            --cache-control max-age=3600

      - name: Invalidate CloudFront cache
        run: |
          aws cloudfront create-invalidation \
            --distribution-id ${{ secrets.CLOUDFRONT_DISTRIBUTION_ID }} \
            --paths "/extensions.json" "/extensions/*"
```

---

## ğŸ“ˆ ã‚³ã‚¹ãƒˆè©¦ç®—ï¼ˆè©³ç´°ï¼‰

### ã‚·ãƒŠãƒªã‚ª1: ç¤¾å†…åˆ©ç”¨ãƒ»å°è¦æ¨¡ï¼ˆ10ã€œ50ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰

| é …ç›®                  | ä½¿ç”¨é‡/æœˆ | å˜ä¾¡          | æœˆé¡      |
| --------------------- | --------- | ------------- | --------- |
| S3 ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸         | 3GB       | $0.023/GB     | $0.07     |
| S3 GET ãƒªã‚¯ã‚¨ã‚¹ãƒˆ     | 500å›     | $0.0004/1,000 | $0.0002   |
| CloudFront ãƒ‡ãƒ¼ã‚¿è»¢é€ | 3GB       | $0.085/GB     | $0.26     |
| CloudFront ãƒªã‚¯ã‚¨ã‚¹ãƒˆ | 500å›     | ç„¡æ–™æ         | $0        |
| **åˆè¨ˆ**              | -         | -             | **$0.33** |

### ã‚·ãƒŠãƒªã‚ª2: ç¤¾å†…åˆ©ç”¨ãƒ»ä¸­è¦æ¨¡ï¼ˆ50ã€œ100ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰

| é …ç›®                  | ä½¿ç”¨é‡/æœˆ | å˜ä¾¡          | æœˆé¡      |
| --------------------- | --------- | ------------- | --------- |
| S3 ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸         | 5GB       | $0.023/GB     | $0.12     |
| S3 GET ãƒªã‚¯ã‚¨ã‚¹ãƒˆ     | 1,000å›   | $0.0004/1,000 | $0.0004   |
| CloudFront ãƒ‡ãƒ¼ã‚¿è»¢é€ | 5GB       | $0.085/GB     | $0.43     |
| CloudFront ãƒªã‚¯ã‚¨ã‚¹ãƒˆ | 1,000å›   | ç„¡æ–™æ         | $0        |
| **åˆè¨ˆ**              | -         | -             | **$0.55** |

### ã‚·ãƒŠãƒªã‚ª3: å°†æ¥çš„ãªå¤–éƒ¨å…¬é–‹ï¼ˆ1,000ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰

| é …ç›®                  | ä½¿ç”¨é‡/æœˆ | å˜ä¾¡          | æœˆé¡      |
| --------------------- | --------- | ------------- | --------- |
| S3 ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸         | 10GB      | $0.023/GB     | $0.23     |
| S3 GET ãƒªã‚¯ã‚¨ã‚¹ãƒˆ     | 10,000å›  | $0.0004/1,000 | $0.004    |
| CloudFront ãƒ‡ãƒ¼ã‚¿è»¢é€ | 10GB      | $0.085/GB     | $0.85     |
| CloudFront ãƒªã‚¯ã‚¨ã‚¹ãƒˆ | 10,000å›  | ç„¡æ–™æ         | $0        |
| **åˆè¨ˆ**              | -         | -             | **$1.08** |

### ã‚·ãƒŠãƒªã‚ª3: å°†æ¥çš„ãªå¤–éƒ¨å…¬é–‹ï¼ˆ1,000ãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼‰

| é …ç›®                  | ä½¿ç”¨é‡/æœˆ | å˜ä¾¡           | æœˆé¡      |
| --------------------- | --------- | -------------- | --------- |
| S3 ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸         | 50GB      | $0.023/GB      | $1.15     |
| S3 GET ãƒªã‚¯ã‚¨ã‚¹ãƒˆ     | 100,000å› | $0.0004/1,000  | $0.04     |
| CloudFront ãƒ‡ãƒ¼ã‚¿è»¢é€ | 100GB     | $0.085/GB      | $8.50     |
| CloudFront ãƒªã‚¯ã‚¨ã‚¹ãƒˆ | 100,000å› | $0.0075/10,000 | $0.075    |
| **åˆè¨ˆ**              | -         | -              | **$9.77** |

### EC2ã¨ã®æ¯”è¼ƒï¼ˆç¤¾å†…åˆ©ç”¨ï¼‰

| æ§‹æˆ                | 10ãƒ¦ãƒ¼ã‚¶ãƒ¼ | 50ãƒ¦ãƒ¼ã‚¶ãƒ¼ | 100ãƒ¦ãƒ¼ã‚¶ãƒ¼ | å‚™è€ƒ             |
| ------------------- | ---------- | ---------- | ----------- | ---------------- |
| **S3 + CloudFront** | $0.33      | $0.55      | $1.00       | å¾“é‡èª²é‡‘         |
| **EC2 t3.micro**    | $10.04     | $10.04     | $10.04      | å›ºå®šè²»           |
| **å·®é¡ï¼ˆå¹´é–“ï¼‰**    | $116       | $114       | $108        | S3ãŒåœ§å€’çš„ã«å®‰ã„ |

**çµè«–**: ç¤¾å†…åˆ©ç”¨ï¼ˆä½ãƒˆãƒ©ãƒ•ã‚£ãƒƒã‚¯ï¼‰ã§ã¯ã€S3 + CloudFrontãŒ**å¹´é–“$100ä»¥ä¸Š**ã®ã‚³ã‚¹ãƒˆå‰Šæ¸›ã«ãªã‚‹

---

## âœ… æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### å³åº§ã«å®Ÿæ–½

1. **AWS ã‚¢ã‚«ã‚¦ãƒ³ãƒˆç¢ºèª** âœ“
2. **ãƒ‰ãƒ¡ã‚¤ãƒ³æº–å‚™** âœ“
3. **ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—**
   - Docker + MinIO + Caddy ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
4. **Terraformç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—**
5. **æœ¬ç•ªç’°å¢ƒæ§‹ç¯‰**
   - S3ãƒã‚±ãƒƒãƒˆä½œæˆ
   - CloudFrontè¨­å®š

### Week 1: ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒ

- âœ… Docker Compose ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- âœ… MinIOï¼ˆS3äº’æ›ï¼‰èµ·å‹•
- âœ… Caddy ãƒªãƒãƒ¼ã‚¹ãƒ—ãƒ­ã‚­ã‚·è¨­å®š
- âœ… extensions.json é…ç½®
- âœ… å‹•ä½œç¢ºèª

### Week 2: æœ¬ç•ªç’°å¢ƒæ§‹ç¯‰

- âœ… S3ãƒã‚±ãƒƒãƒˆä½œæˆ
- âœ… CloudFrontè¨­å®š
- âœ… CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹ç¯‰
- âœ… æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤

### ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ›´æ–°

- `development-server-specification.md` ã«MinIO + Caddyæ§‹æˆã‚’è¿½è¨˜
- ã‚¤ãƒ³ãƒ•ãƒ©æ§‹æˆå›³ã‚’è¿½åŠ 
- é‹ç”¨æ‰‹é †æ›¸ã‚’ä½œæˆ

---

## ğŸ”— å‚è€ƒãƒªãƒ³ã‚¯

### AWS

- [AWS S3 æ–™é‡‘](https://aws.amazon.com/s3/pricing/)
- [AWS CloudFront æ–™é‡‘](https://aws.amazon.com/cloudfront/pricing/)
- [Terraform AWS Provider](https://registry.terraform.io/providers/hashicorp/aws/latest/docs)

### ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™º

- [MinIO - S3äº’æ›ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸](https://min.io/)
- [MinIO Docker Hub](https://hub.docker.com/r/minio/minio)
- [Caddy å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://caddyserver.com/docs/)
- [LocalStack - AWSã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿](https://localstack.cloud/)

### CI/CD

- [GitHub Actions - AWS](https://github.com/aws-actions)

---

**Document Version**: 2.0.0
**Last Updated**: 2025å¹´9æœˆ30æ—¥
**Changes**: ç¤¾å†…åˆ©ç”¨å‰æã€ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºç’°å¢ƒï¼ˆMinIOï¼‰è¿½åŠ 
**Maintained by**: Lichtblick Development Team

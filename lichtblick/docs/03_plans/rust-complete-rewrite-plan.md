# Lichtblick Rustå®Œå…¨å†ç¾ å®Ÿè£…è¨ˆç”»æ›¸

**ä½œæˆæ—¥**: 2025-01-XX
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0
**å¯¾è±¡**: Lichtblickå®Œå…¨å†ç¾ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆRustå®Ÿè£…ï¼‰

---

## ğŸ“‹ ç›®æ¬¡

1. [æ¦‚è¦](#æ¦‚è¦)
2. [ç¾çŠ¶åˆ†æ](#ç¾çŠ¶åˆ†æ)
3. [æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯é¸å®š](#æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯é¸å®š)
4. [ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ](#ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ)
5. [æ®µéšçš„å®Ÿè£…è¨ˆç”»](#æ®µéšçš„å®Ÿè£…è¨ˆç”»)
6. [ä¸»è¦æ©Ÿèƒ½ã®å®Ÿè£…æ–¹é‡](#ä¸»è¦æ©Ÿèƒ½ã®å®Ÿè£…æ–¹é‡)
7. [ç§»è¡Œæˆ¦ç•¥](#ç§»è¡Œæˆ¦ç•¥)
8. [ãƒªã‚¹ã‚¯åˆ†æã¨å¯¾ç­–](#ãƒªã‚¹ã‚¯åˆ†æã¨å¯¾ç­–)
9. [é–‹ç™ºãƒªã‚½ãƒ¼ã‚¹è¦‹ç©ã‚‚ã‚Š](#é–‹ç™ºãƒªã‚½ãƒ¼ã‚¹è¦‹ç©ã‚‚ã‚Š)

---

## æ¦‚è¦

### ç›®çš„

Lichtblickã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’Rustã§å®Œå…¨å†ç¾ã—ã€ä»¥ä¸‹ã®ç›®æ¨™ã‚’é”æˆã™ã‚‹ï¼š

- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š**: ãƒ¡ãƒ¢ãƒªå®‰å…¨æ€§ã¨é«˜é€Ÿå‡¦ç†
- **ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **: Webã€Desktopï¼ˆWindowsã€macOSã€Linuxï¼‰å¯¾å¿œ
- **æ©Ÿèƒ½å®Œå…¨æ€§**: æ—¢å­˜ã®å…¨æ©Ÿèƒ½ã‚’å†ç¾
- **æ‹¡å¼µæ€§**: æ‹¡å¼µæ©Ÿèƒ½ã‚·ã‚¹ãƒ†ãƒ ã®ç¶­æŒ

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¹ã‚³ãƒ¼ãƒ—

**å¯¾è±¡æ©Ÿèƒ½**:

- âœ… ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ç®¡ç†ï¼ˆMCAPã€ROS1/ROS2ã€WebSocketç­‰ï¼‰
- âœ… 3Då¯è¦–åŒ–ï¼ˆç‚¹ç¾¤ã€ãƒ¡ãƒƒã‚·ãƒ¥ã€URDFç­‰ï¼‰
- âœ… ãƒ‘ãƒãƒ«ã‚·ã‚¹ãƒ†ãƒ ï¼ˆPlotã€Imageã€Mapã€Logç­‰ï¼‰
- âœ… æ‹¡å¼µæ©Ÿèƒ½ã‚·ã‚¹ãƒ†ãƒ 
- âœ… ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆç®¡ç†
- âœ… ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹æ©Ÿèƒ½

**éå¯¾è±¡**:

- æ—¢å­˜ã®TypeScriptã‚³ãƒ¼ãƒ‰ã¨ã®äº’æ›æ€§ï¼ˆå®Œå…¨å†å®Ÿè£…ã®ãŸã‚ï¼‰

---

## ç¾çŠ¶åˆ†æ

### ç¾åœ¨ã®Lichtblickã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

#### æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯

```
ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰:
â”œâ”€â”€ TypeScript 5.3.3
â”œâ”€â”€ React 18.3.1
â”œâ”€â”€ Three.js 0.156.1 (3Då¯è¦–åŒ–)
â”œâ”€â”€ Material-UI 7.2.0
â”œâ”€â”€ Zustand 4.5.7 (çŠ¶æ…‹ç®¡ç†)
â””â”€â”€ Electron 39.0.0 (ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—)

ãƒ‡ãƒ¼ã‚¿å‡¦ç†:
â”œâ”€â”€ MCAP ã‚µãƒãƒ¼ãƒˆ
â”œâ”€â”€ ROS1/ROS2 ã‚µãƒãƒ¼ãƒˆ
â”œâ”€â”€ WebSocket é€šä¿¡
â””â”€â”€ å„ç¨®ãƒ•ã‚¡ã‚¤ãƒ«ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ

3Då¯è¦–åŒ–:
â”œâ”€â”€ Three.js ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
â”œâ”€â”€ WebGL ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ
â”œâ”€â”€ ç‚¹ç¾¤å‡¦ç†
â””â”€â”€ URDF ãƒ‘ãƒ¼ã‚¹
```

#### ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ

1. **ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ç®¡ç†**

   - `IDataSourceFactory` ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
   - 9ç¨®é¡ã®ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹å®Ÿè£…
   - Playeréšå±¤åŒ–ã‚·ã‚¹ãƒ†ãƒ 

2. **3Då¯è¦–åŒ–**

   - `Renderer` ã‚¯ãƒ©ã‚¹ï¼ˆThree.jsï¼‰
   - `SceneExtension` ã‚·ã‚¹ãƒ†ãƒ 
   - 187ãƒ•ã‚¡ã‚¤ãƒ«ã®å¤§è¦æ¨¡å®Ÿè£…

3. **ãƒ‘ãƒãƒ«ã‚·ã‚¹ãƒ†ãƒ **

   - 20ç¨®é¡ä»¥ä¸Šã®ãƒ‘ãƒãƒ«
   - å‹•çš„ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆç®¡ç†
   - è¨­å®šãƒ„ãƒªãƒ¼ã‚·ã‚¹ãƒ†ãƒ 

4. **æ‹¡å¼µæ©Ÿèƒ½**
   - `.foxe` ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼
   - å‹•çš„ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
   - ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹çµ±åˆ

#### ã‚³ãƒ¼ãƒ‰è¦æ¨¡

- **ç·ãƒ•ã‚¡ã‚¤ãƒ«æ•°**: ç´„1,600ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆsuite-baseã®ã¿ï¼‰
- **TypeScript/TSX**: ç´„1,500ãƒ•ã‚¡ã‚¤ãƒ«
- **3Då¯è¦–åŒ–**: 187ãƒ•ã‚¡ã‚¤ãƒ«
- **ãƒ‘ãƒãƒ«**: 20+ãƒ‘ãƒãƒ«ã€å„10-30ãƒ•ã‚¡ã‚¤ãƒ«

---

## æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯é¸å®š

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰UI

#### æ¨å¥¨: eguiï¼ˆå®Œå…¨Rust UIï¼‰ â­â­â­â­â­

**æ§‹æˆ**:

- **egui 0.27+**: ã‚¤ãƒŸãƒ‡ã‚£ã‚¨ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰UI
- **eframe**: ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **wgpu**: 3Då¯è¦–åŒ–ï¼ˆeguiã¨ç›´æ¥çµ±åˆï¼‰

**ãƒ¡ãƒªãƒƒãƒˆ**:

- âœ… **å®Œå…¨ãªRustå®Ÿè£…**: WebæŠ€è¡“ã«ä¾å­˜ã—ãªã„
- âœ… **wgpuçµ±åˆãŒæœ€ã‚‚å®¹æ˜“**: eguiã¯wgpuã‚’ç›´æ¥ä½¿ç”¨
- âœ… **ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**: 60fpsä»¥ä¸Šã®ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
- âœ… **æˆç†Ÿåº¦ãŒé«˜ã„**: å¤šãã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ä½¿ç”¨å®Ÿç¸¾
- âœ… **ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ **: Webã€Desktopå¯¾å¿œ
- âœ… **è¤‡é›‘ãªUIã«é©ã—ã¦ã„ã‚‹**: ãƒ‘ãƒãƒ«ã‚·ã‚¹ãƒ†ãƒ ã€å‹•çš„ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã«æœ€é©

**ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ**:

- âš ï¸ ã‚¤ãƒŸãƒ‡ã‚£ã‚¨ã‚¤ãƒˆãƒ¢ãƒ¼ãƒ‰ã®åˆ¶ç´„ï¼ˆæ¯ãƒ•ãƒ¬ãƒ¼ãƒ å†æç”»ï¼‰
- âš ï¸ WebAssemblyã§ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹åˆ¶é™ï¼ˆWebç‰ˆï¼‰

**è©³ç´°**: è©³ç´°ãªæ¯”è¼ƒã¯ [`rust-frontend-framework-comparison.md`](./rust-frontend-framework-comparison.md) ã‚’å‚ç…§

#### ä»£æ›¿æ¡ˆ: icedï¼ˆElmé¢¨UIï¼‰

**æ§‹æˆ**:

- **iced 0.12+**: é–¢æ•°å‹UIãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **wgpu**: 3Då¯è¦–åŒ–ï¼ˆã‚«ã‚¹ã‚¿ãƒ ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼å¿…è¦ï¼‰

**ãƒ¡ãƒªãƒƒãƒˆ**:

- âœ… é–¢æ•°å‹ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£
- âœ… å®Œå…¨ãªRustå®Ÿè£…
- âœ… å®£è¨€çš„UI

**ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ**:

- âŒ wgpuçµ±åˆãŒè¤‡é›‘ï¼ˆã‚«ã‚¹ã‚¿ãƒ ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ãŒå¿…è¦ï¼‰
- âŒ å­¦ç¿’æ›²ç·šãŒé«˜ã„
- âŒ 3Då¯è¦–åŒ–ã®çµ±åˆãŒå›°é›£

**æ¨å¥¨**: **egui** - wgpuçµ±åˆãŒå®¹æ˜“ã§ã€Lichtblickã®è¦ä»¶ã«æœ€é©

### 3Då¯è¦–åŒ–

#### ã‚ªãƒ—ã‚·ãƒ§ãƒ³1: wgpu + WebGPU â­æ¨å¥¨

**æ§‹æˆ**:

- **wgpu 0.20+**: ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚¹API
- **WebAssembly**: ãƒ–ãƒ©ã‚¦ã‚¶å¯¾å¿œ

**ãƒ¡ãƒªãƒƒãƒˆ**:

- âœ… ãƒã‚¤ãƒ†ã‚£ãƒ–ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹
- âœ… WebAssemblyçµŒç”±ã§ãƒ–ãƒ©ã‚¦ã‚¶å¯¾å¿œ
- âœ… Vulkan/Metal/DirectX 12å¯¾å¿œ

**å®Ÿè£…ä¾‹**:

```rust
use wgpu::*;

pub struct Renderer {
    device: Device,
    queue: Queue,
    surface: Surface,
    config: SurfaceConfiguration,
}

impl Renderer {
    pub fn new(window: &Window) -> Self {
        // wgpuåˆæœŸåŒ–
        let instance = Instance::new(InstanceDescriptor::default());
        let surface = instance.create_surface(SurfaceTarget::Window(window)).unwrap();
        // ...
    }
}
```

#### ã‚ªãƒ—ã‚·ãƒ§ãƒ³2: bevyï¼ˆã‚²ãƒ¼ãƒ ã‚¨ãƒ³ã‚¸ãƒ³ï¼‰

**æ§‹æˆ**:

- **bevy 0.13+**: ECSï¼ˆEntity Component Systemï¼‰ãƒ™ãƒ¼ã‚¹

**ãƒ¡ãƒªãƒƒãƒˆ**:

- âœ… é«˜æ©Ÿèƒ½ãª3Dã‚¨ãƒ³ã‚¸ãƒ³
- âœ… æ‹¡å¼µæ€§ãŒé«˜ã„

**ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ**:

- âš ï¸ ã‚²ãƒ¼ãƒ ã‚¨ãƒ³ã‚¸ãƒ³ã¨ã—ã¦è¨­è¨ˆã•ã‚Œã¦ãŠã‚Šã€å¯è¦–åŒ–ãƒ„ãƒ¼ãƒ«ã«ã¯éå‰°
- âš ï¸ å­¦ç¿’æ›²ç·šãŒé«˜ã„

**æ¨å¥¨**: **ã‚ªãƒ—ã‚·ãƒ§ãƒ³1ï¼ˆwgpuï¼‰** - è»½é‡ã§æŸ”è»Ÿ

### ãƒ‡ãƒ¼ã‚¿å‡¦ç†

#### ROS2ã‚µãƒãƒ¼ãƒˆ

**ãƒ©ã‚¤ãƒ–ãƒ©ãƒª**: `rclrs` (ROS2 Rust Client Library)

```rust
use rclrs::{Context, Node, Subscription};

pub struct Ros2DataSource {
    context: Context,
    node: Node,
    subscriptions: Vec<Subscription>,
}
```

#### MCAPã‚µãƒãƒ¼ãƒˆ

**å®Ÿè£…æ–¹é‡**: Rustã§MCAPãƒªãƒ¼ãƒ€ãƒ¼ã‚’å®Ÿè£…

```rust
use mcap_rs::{McapReader, Message};

pub struct McapDataSource {
    reader: McapReader,
    topics: Vec<String>,
}
```

#### WebSocketã‚µãƒãƒ¼ãƒˆ

**ãƒ©ã‚¤ãƒ–ãƒ©ãƒª**: `tokio-tungstenite` ã¾ãŸã¯ `axum` (WebSocket)

```rust
use tokio_tungstenite::{connect_async, WebSocketStream};

pub struct WebSocketDataSource {
    stream: WebSocketStream<TcpStream>,
}
```

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼

**ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯**: **Axum** â­æ¨å¥¨

```rust
use axum::{Router, routing::get, Json};

let app = Router::new()
    .route("/v1/extensions", get(get_extensions))
    .route("/v1/layouts", get(get_layouts));
```

**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: **sqlx** (PostgreSQL)

```rust
use sqlx::PgPool;

pub struct Database {
    pool: PgPool,
}
```

---

## ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ

### å…¨ä½“ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Application Layer                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Frontend (Tauri + React)                               â”‚
â”‚  â”œâ”€â”€ UI Components                                       â”‚
â”‚  â”œâ”€â”€ Panel System                                        â”‚
â”‚  â””â”€â”€ Layout Management                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Rust Backend (Tauri Commands)                          â”‚
â”‚  â”œâ”€â”€ Data Source Manager                                 â”‚
â”‚  â”œâ”€â”€ Player System                                       â”‚
â”‚  â”œâ”€â”€ Message Pipeline                                    â”‚
â”‚  â””â”€â”€ Extension Loader                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Rendering Engine (wgpu)                                 â”‚
â”‚  â”œâ”€â”€ 3D Scene Management                                 â”‚
â”‚  â”œâ”€â”€ Point Cloud Renderer                                â”‚
â”‚  â”œâ”€â”€ Mesh Renderer                                       â”‚
â”‚  â””â”€â”€ URDF Parser                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Data Processing                                         â”‚
â”‚  â”œâ”€â”€ MCAP Reader                                         â”‚
â”‚  â”œâ”€â”€ ROS2 Client (rclrs)                                 â”‚
â”‚  â”œâ”€â”€ WebSocket Handler                                   â”‚
â”‚  â””â”€â”€ Message Deserialization                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æ§‹é€ 

```
lichtblick-rust/
â”œâ”€â”€ crates/
â”‚   â”œâ”€â”€ lichtblick-core/          # ã‚³ã‚¢ãƒ­ã‚¸ãƒƒã‚¯
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ data_source/      # ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ player/           # Playerã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”‚   â”‚   â”œâ”€â”€ pipeline/         # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
â”‚   â”‚   â”‚   â””â”€â”€ extension/        # æ‹¡å¼µæ©Ÿèƒ½ã‚·ã‚¹ãƒ†ãƒ 
â”‚   â”‚
â”‚   â”œâ”€â”€ lichtblick-renderer/      # 3Då¯è¦–åŒ–ã‚¨ãƒ³ã‚¸ãƒ³
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ scene/            # ã‚·ãƒ¼ãƒ³ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ renderables/      # ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ–ãƒ«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
â”‚   â”‚   â”‚   â””â”€â”€ camera/           # ã‚«ãƒ¡ãƒ©åˆ¶å¾¡
â”‚   â”‚
â”‚   â”œâ”€â”€ lichtblick-panels/        # ãƒ‘ãƒãƒ«å®Ÿè£…
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ plot/              # Plotãƒ‘ãƒãƒ«
â”‚   â”‚   â”‚   â”œâ”€â”€ image/             # Imageãƒ‘ãƒãƒ«
â”‚   â”‚   â”‚   â”œâ”€â”€ map/               # Mapãƒ‘ãƒãƒ«
â”‚   â”‚   â”‚   â””â”€â”€ three_dee/         # 3Då¯è¦–åŒ–ãƒ‘ãƒãƒ«
â”‚   â”‚
â”‚   â”œâ”€â”€ lichtblick-data/          # ãƒ‡ãƒ¼ã‚¿å‡¦ç†
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ mcap/              # MCAPãƒªãƒ¼ãƒ€ãƒ¼
â”‚   â”‚   â”‚   â”œâ”€â”€ ros2/              # ROS2ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ
â”‚   â”‚   â”‚   â”œâ”€â”€ websocket/         # WebSocketå‡¦ç†
â”‚   â”‚   â”‚   â””â”€â”€ message/           # ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ lichtblick-server/        # ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ api/               # REST API
â”‚   â”‚   â”‚   â”œâ”€â”€ database/          # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
â”‚   â”‚   â”‚   â””â”€â”€ storage/           # ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
â”‚   â”‚
â”‚   â””â”€â”€ lichtblick-tauri/         # Tauriã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
â”‚       â”œâ”€â”€ src-tauri/
â”‚       â”‚   â”œâ”€â”€ src/
â”‚       â”‚   â”‚   â”œâ”€â”€ commands/      # Tauriã‚³ãƒãƒ³ãƒ‰
â”‚       â”‚   â”‚   â””â”€â”€ main.rs        # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚       â””â”€â”€ src/                  # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆReactï¼‰
â”‚
â””â”€â”€ workspace/
    â””â”€â”€ Cargo.toml                 # ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹è¨­å®š
```

### ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ

```rust
// ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æŠ½è±¡åŒ–
pub trait DataSource: Send + Sync {
    fn id(&self) -> &str;
    fn initialize(&mut self) -> Result<(), DataSourceError>;
    fn get_messages(&mut self, topics: &[String]) -> Result<Vec<Message>, DataSourceError>;
    fn close(&mut self);
}

// PlayeræŠ½è±¡åŒ–
pub trait Player: Send + Sync {
    fn play(&mut self) -> Result<(), PlayerError>;
    fn pause(&mut self);
    fn seek(&mut self, timestamp: u64) -> Result<(), PlayerError>;
    fn get_state(&self) -> PlayerState;
}

// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
pub struct MessagePipeline {
    subscriptions: HashMap<String, Vec<Subscriber>>,
    player: Box<dyn Player>,
}

impl MessagePipeline {
    pub fn subscribe(&mut self, topic: String, subscriber: Subscriber) {
        self.subscriptions.entry(topic).or_insert_with(Vec::new).push(subscriber);
    }

    pub fn process_messages(&mut self, messages: Vec<Message>) {
        for message in messages {
            if let Some(subscribers) = self.subscriptions.get(&message.topic) {
                for subscriber in subscribers {
                    subscriber.handle_message(&message);
                }
            }
        }
    }
}
```

---

## æ®µéšçš„å®Ÿè£…è¨ˆç”»

### Phase 1: åŸºç›¤æ§‹ç¯‰ï¼ˆ2-3ãƒ¶æœˆï¼‰

**ç›®æ¨™**: åŸºæœ¬çš„ãªã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã‚³ã‚¢æ©Ÿèƒ½ã®å®Ÿè£…

#### 1.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

- [ ] Cargoãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ã®æ§‹ç¯‰
- [ ] Tauriãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®åˆæœŸåŒ–
- [ ] åŸºæœ¬çš„ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®ä½œæˆ
- [ ] CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã®è¨­å®š

#### 1.2 ã‚³ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒªå®Ÿè£…

- [ ] `lichtblick-core`: ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æŠ½è±¡åŒ–
- [ ] `lichtblick-core`: Playerã‚·ã‚¹ãƒ†ãƒ 
- [ ] `lichtblick-core`: ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
- [ ] åŸºæœ¬çš„ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

#### 1.3 ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹å®Ÿè£…ï¼ˆå„ªå…ˆé †ä½é †ï¼‰

1. **MCAP Local File** â­æœ€å„ªå…ˆ

   - MCAPãƒªãƒ¼ãƒ€ãƒ¼ã®å®Ÿè£…
   - ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
   - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³

2. **ROS2 WebSocket**

   - rclrsçµ±åˆ
   - WebSocketé€šä¿¡
   - ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è³¼èª­

3. **Remote File**
   - HTTPãƒ•ã‚¡ã‚¤ãƒ«ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
   - ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°èª­ã¿è¾¼ã¿

#### 1.4 åŸºæœ¬çš„ãªUIå®Ÿè£…

- [ ] Tauri + Reactã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- [ ] ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹é¸æŠUI
- [ ] åŸºæœ¬çš„ãªãƒ‘ãƒãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
- [ ] ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºãƒ‘ãƒãƒ«ï¼ˆRawMessagesï¼‰

**æˆæœç‰©**:

- MCAPãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿è¾¼ã‚“ã§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã§ãã‚‹
- åŸºæœ¬çš„ãªUIãŒå‹•ä½œã™ã‚‹

---

### Phase 2: 3Då¯è¦–åŒ–ã‚¨ãƒ³ã‚¸ãƒ³ï¼ˆ3-4ãƒ¶æœˆï¼‰

**ç›®æ¨™**: wgpuãƒ™ãƒ¼ã‚¹ã®3Då¯è¦–åŒ–ã‚¨ãƒ³ã‚¸ãƒ³ã®å®Ÿè£…

#### 2.1 wgpuãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼å®Ÿè£…

- [ ] wgpuã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®åˆæœŸåŒ–
- [ ] åŸºæœ¬çš„ãªã‚·ãƒ¼ãƒ³ç®¡ç†
- [ ] ã‚«ãƒ¡ãƒ©ã‚·ã‚¹ãƒ†ãƒ 
- [ ] åº§æ¨™å¤‰æ›ã‚·ã‚¹ãƒ†ãƒ ï¼ˆTransform Treeï¼‰

#### 2.2 åŸºæœ¬çš„ãªãƒ¬ãƒ³ãƒ€ãƒ©ãƒ–ãƒ«å®Ÿè£…

1. **ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–å½¢çŠ¶**

   - [ ] Cubeï¼ˆç«‹æ–¹ä½“ï¼‰
   - [ ] Sphereï¼ˆçƒï¼‰
   - [ ] Cylinderï¼ˆå††æŸ±ï¼‰
   - [ ] Arrowï¼ˆçŸ¢å°ï¼‰

2. **ç‚¹ç¾¤ãƒ‡ãƒ¼ã‚¿**

   - [ ] PointCloudãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼
   - [ ] å¤§é‡ç‚¹ã®æœ€é©åŒ–ï¼ˆLODã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚·ãƒ³ã‚°ï¼‰

3. **ãƒ¡ãƒƒã‚·ãƒ¥ãƒ‡ãƒ¼ã‚¿**
   - [ ] Meshãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼
   - [ ] ãƒ†ã‚¯ã‚¹ãƒãƒ£ãƒãƒƒãƒ”ãƒ³ã‚°
   - [ ] ãƒãƒ†ãƒªã‚¢ãƒ«ã‚·ã‚¹ãƒ†ãƒ 

#### 2.3 URDFã‚µãƒãƒ¼ãƒˆ

- [ ] URDFãƒ‘ãƒ¼ã‚µãƒ¼å®Ÿè£…
- [ ] ãƒ­ãƒœãƒƒãƒˆãƒ¢ãƒ‡ãƒ«ã®èª­ã¿è¾¼ã¿
- [ ] éšå±¤æ§‹é€ ã®å¯è¦–åŒ–

#### 2.4 3Dãƒ‘ãƒãƒ«çµ±åˆ

- [ ] ThreeDeeRenderãƒ‘ãƒãƒ«ã®å®Ÿè£…
- [ ] è¨­å®šãƒ„ãƒªãƒ¼ã‚·ã‚¹ãƒ†ãƒ 
- [ ] ã‚«ãƒ¡ãƒ©åˆ¶å¾¡UI

**æˆæœç‰©**:

- 3Dã‚·ãƒ¼ãƒ³ã‚’è¡¨ç¤ºã§ãã‚‹
- ç‚¹ç¾¤ãƒ‡ãƒ¼ã‚¿ã‚’å¯è¦–åŒ–ã§ãã‚‹
- URDFãƒ¢ãƒ‡ãƒ«ã‚’è¡¨ç¤ºã§ãã‚‹

---

### Phase 3: ãƒ‘ãƒãƒ«ã‚·ã‚¹ãƒ†ãƒ æ‹¡å¼µï¼ˆ2-3ãƒ¶æœˆï¼‰

**ç›®æ¨™**: ä¸»è¦ãƒ‘ãƒãƒ«ã®å®Ÿè£…

#### 3.1 ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–ãƒ‘ãƒãƒ«

1. **Plotãƒ‘ãƒãƒ«** â­æœ€å„ªå…ˆ

   - [ ] ãƒãƒ£ãƒ¼ãƒˆãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ï¼ˆChart.jsä»£æ›¿ï¼‰
   - [ ] æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º
   - [ ] ã‚ºãƒ¼ãƒ ãƒ»ãƒ‘ãƒ³æ©Ÿèƒ½

2. **Imageãƒ‘ãƒãƒ«**

   - [ ] ç”»åƒè¡¨ç¤º
   - [ ] ã‚«ãƒ¡ãƒ©ç”»åƒã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤
   - [ ] ç”»åƒã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

3. **Mapãƒ‘ãƒãƒ«**
   - [ ] åœ°å›³è¡¨ç¤ºï¼ˆLeafletä»£æ›¿ï¼‰
   - [ ] GPSè»Œè·¡è¡¨ç¤º
   - [ ] ãƒãƒ¼ã‚«ãƒ¼è¡¨ç¤º

#### 3.2 è¨ºæ–­ãƒ‘ãƒãƒ«

- [ ] Logãƒ‘ãƒãƒ«
- [ ] DiagnosticStatusãƒ‘ãƒãƒ«
- [ ] DiagnosticSummaryãƒ‘ãƒãƒ«

#### 3.3 ãã®ä»–ãƒ‘ãƒãƒ«

- [ ] Tableãƒ‘ãƒãƒ«
- [ ] RawMessagesãƒ‘ãƒãƒ«
- [ ] Parametersãƒ‘ãƒãƒ«

**æˆæœç‰©**:

- ä¸»è¦ãƒ‘ãƒãƒ«ãŒå‹•ä½œã™ã‚‹
- ãƒ‡ãƒ¼ã‚¿å¯è¦–åŒ–ãŒå¯èƒ½

---

### Phase 4: æ‹¡å¼µæ©Ÿèƒ½ã‚·ã‚¹ãƒ†ãƒ ï¼ˆ2-3ãƒ¶æœˆï¼‰

**ç›®æ¨™**: æ‹¡å¼µæ©Ÿèƒ½ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…

#### 4.1 æ‹¡å¼µæ©Ÿèƒ½ãƒ­ãƒ¼ãƒ€ãƒ¼

- [ ] `.foxe` ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼ã®ã‚µãƒãƒ¼ãƒˆ
- [ ] æ‹¡å¼µæ©Ÿèƒ½ã®å‹•çš„ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°
- [ ] æ‹¡å¼µæ©Ÿèƒ½ã®ã‚µãƒ³ãƒ‰ãƒœãƒƒã‚¯ã‚¹åŒ–

#### 4.2 æ‹¡å¼µæ©Ÿèƒ½API

- [ ] ãƒ‘ãƒãƒ«æ‹¡å¼µAPI
- [ ] ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚³ãƒ³ãƒãƒ¼ã‚¿ãƒ¼API
- [ ] ã‚«ãƒ¡ãƒ©ãƒ¢ãƒ‡ãƒ«API

#### 4.3 ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹çµ±åˆ

- [ ] æ‹¡å¼µæ©Ÿèƒ½ã‚«ã‚¿ãƒ­ã‚°ã®å–å¾—
- [ ] æ‹¡å¼µæ©Ÿèƒ½ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- [ ] æ‹¡å¼µæ©Ÿèƒ½ã®æ›´æ–°ç®¡ç†

**æˆæœç‰©**:

- æ‹¡å¼µæ©Ÿèƒ½ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»ä½¿ç”¨ã§ãã‚‹
- ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹ã‹ã‚‰æ‹¡å¼µæ©Ÿèƒ½ã‚’å–å¾—ã§ãã‚‹

---

### Phase 5: é«˜åº¦ãªæ©Ÿèƒ½ï¼ˆ2-3ãƒ¶æœˆï¼‰

**ç›®æ¨™**: é«˜åº¦ãªæ©Ÿèƒ½ã¨æœ€é©åŒ–

#### 5.1 ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹æ‹¡å¼µ

- [ ] ROS1 Bagã‚µãƒãƒ¼ãƒˆ
- [ ] ROS2 Bagã‚µãƒãƒ¼ãƒˆ
- [ ] ULogï¼ˆPX4ï¼‰ã‚µãƒãƒ¼ãƒˆ
- [ ] Velodyneãƒ‡ãƒ¼ã‚¿ã‚µãƒãƒ¼ãƒˆ

#### 5.2 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

- [ ] ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°æœ€é©åŒ–
- [ ] ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æœ€é©åŒ–
- [ ] ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®æœ€é©åŒ–

#### 5.3 ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½“é¨“å‘ä¸Š

- [ ] ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆç®¡ç†ã®æ”¹å–„
- [ ] è¨­å®šã®æ°¸ç¶šåŒ–
- [ ] ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ
- [ ] ãƒãƒ«ãƒãƒ•ã‚¡ã‚¤ãƒ«ã‚µãƒãƒ¼ãƒˆ

**æˆæœç‰©**:

- å…¨ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ãŒå‹•ä½œã™ã‚‹
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒæœ€é©åŒ–ã•ã‚Œã¦ã„ã‚‹

---

### Phase 6: ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã‚µãƒ¼ãƒãƒ¼ï¼ˆ1-2ãƒ¶æœˆï¼‰

**ç›®æ¨™**: ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹ã‚µãƒ¼ãƒãƒ¼ã®å®Ÿè£…

#### 6.1 REST APIå®Ÿè£…

- [ ] Extensions API
- [ ] Layouts API
- [ ] URDF Models API
- [ ] Sample Data API

#### 6.2 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆ

- [ ] PostgreSQLã‚¹ã‚­ãƒ¼ãƒ
- [ ] sqlxçµ±åˆ
- [ ] ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚·ã‚¹ãƒ†ãƒ 

#### 6.3 ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸

- [ ] ã‚¢ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
- [ ] ãƒ•ã‚¡ã‚¤ãƒ«é…ä¿¡
- [ ] ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†

**æˆæœç‰©**:

- ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ—ãƒ¬ã‚¤ã‚¹ã‚µãƒ¼ãƒãƒ¼ãŒå‹•ä½œã™ã‚‹
- ã‚¢ã‚»ãƒƒãƒˆã®ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ»é…ä¿¡ãŒå¯èƒ½

---

### Phase 7: ãƒ†ã‚¹ãƒˆã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆ1-2ãƒ¶æœˆï¼‰

**ç›®æ¨™**: å“è³ªä¿è¨¼ã¨ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™

#### 7.1 ãƒ†ã‚¹ãƒˆ

- [ ] å˜ä½“ãƒ†ã‚¹ãƒˆï¼ˆå„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ï¼‰
- [ ] çµ±åˆãƒ†ã‚¹ãƒˆ
- [ ] E2Eãƒ†ã‚¹ãƒˆ
- [ ] ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ

#### 7.2 ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- [ ] APIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆrustdocï¼‰
- [ ] ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰
- [ ] é–‹ç™ºè€…ã‚¬ã‚¤ãƒ‰
- [ ] ç§»è¡Œã‚¬ã‚¤ãƒ‰

**æˆæœç‰©**:

- ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Š
- å®Œå…¨ãªãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

---

## ä¸»è¦æ©Ÿèƒ½ã®å®Ÿè£…æ–¹é‡

### 1. ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ç®¡ç†

```rust
// crates/lichtblick-core/src/data_source/mod.rs

pub trait DataSource: Send + Sync {
    fn id(&self) -> &str;
    fn display_name(&self) -> &str;
    fn initialize(&mut self, args: DataSourceArgs) -> Result<Box<dyn Player>, DataSourceError>;
    fn supported_file_types(&self) -> &[String];
}

pub struct DataSourceManager {
    sources: Vec<Box<dyn DataSource>>,
}

impl DataSourceManager {
    pub fn register(&mut self, source: Box<dyn DataSource>) {
        self.sources.push(source);
    }

    pub fn find(&self, id: &str) -> Option<&dyn DataSource> {
        self.sources.iter().find(|s| s.id() == id).map(|s| s.as_ref())
    }
}
```

### 2. Playerã‚·ã‚¹ãƒ†ãƒ 

```rust
// crates/lichtblick-core/src/player/mod.rs

pub trait Player: Send + Sync {
    fn play(&mut self) -> Result<(), PlayerError>;
    fn pause(&mut self);
    fn seek(&mut self, timestamp: u64) -> Result<(), PlayerError>;
    fn get_state(&self) -> PlayerState;
    fn get_messages(&mut self, topics: &[String]) -> Result<Vec<Message>, PlayerError>;
}

pub struct IterablePlayer {
    source: Box<dyn IterableSource>,
    state: PlayerState,
    subscriptions: Vec<String>,
}

impl Player for IterablePlayer {
    // å®Ÿè£…
}
```

### 3. 3Då¯è¦–åŒ–ã‚¨ãƒ³ã‚¸ãƒ³

```rust
// crates/lichtblick-renderer/src/scene/mod.rs

pub struct Scene {
    renderables: Vec<Box<dyn Renderable>>,
    camera: Camera,
    lights: Vec<Light>,
}

pub trait Renderable: Send + Sync {
    fn render(&self, encoder: &mut wgpu::CommandEncoder, view: &wgpu::TextureView);
    fn update(&mut self, time: u64);
}

pub struct PointCloudRenderable {
    geometry: PointCloudGeometry,
    material: Material,
}

impl Renderable for PointCloudRenderable {
    // wgpuå®Ÿè£…
}
```

### 4. ãƒ‘ãƒãƒ«ã‚·ã‚¹ãƒ†ãƒ 

```rust
// crates/lichtblick-panels/src/lib.rs

pub trait Panel: Send + Sync {
    fn id(&self) -> &str;
    fn title(&self) -> &str;
    fn render(&mut self, ctx: &mut RenderContext) -> Result<(), PanelError>;
    fn settings(&self) -> SettingsTree;
}

pub struct PlotPanel {
    data: Vec<DataPoint>,
    config: PlotConfig,
}

impl Panel for PlotPanel {
    // å®Ÿè£…
}
```

---

## ç§»è¡Œæˆ¦ç•¥

### æ®µéšçš„ç§»è¡Œã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

#### Step 1: ä¸¦è¡Œé–‹ç™ºæœŸé–“ï¼ˆ6ãƒ¶æœˆï¼‰

- æ—¢å­˜ã®TypeScriptç‰ˆã‚’ç¶­æŒ
- Rustç‰ˆã‚’ä¸¦è¡Œã—ã¦é–‹ç™º
- æ©Ÿèƒ½ã®äº’æ›æ€§ã‚’ç¢ºèª

#### Step 2: ãƒ™ãƒ¼ã‚¿ãƒªãƒªãƒ¼ã‚¹ï¼ˆ3ãƒ¶æœˆï¼‰

- é™å®šçš„ãªãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ãƒ™ãƒ¼ã‚¿ç‰ˆã‚’æä¾›
- ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’åé›†
- ãƒã‚°ä¿®æ­£ã¨æ©Ÿèƒ½æ”¹å–„

#### Step 3: æ­£å¼ãƒªãƒªãƒ¼ã‚¹

- Rustç‰ˆã‚’æ­£å¼ãƒªãƒªãƒ¼ã‚¹
- TypeScriptç‰ˆã®ã‚µãƒãƒ¼ãƒˆçµ‚äº†ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
- ç§»è¡Œã‚¬ã‚¤ãƒ‰ã®æä¾›

### ãƒ‡ãƒ¼ã‚¿äº’æ›æ€§

- **ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆãƒ•ã‚¡ã‚¤ãƒ«**: JSONå½¢å¼ã‚’ç¶­æŒ
- **æ‹¡å¼µæ©Ÿèƒ½**: `.foxe`å½¢å¼ã‚’ç¶­æŒ
- **è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«**: æ—¢å­˜å½¢å¼ã¨ã®äº’æ›æ€§ã‚’ç¶­æŒ

---

## ãƒªã‚¹ã‚¯åˆ†æã¨å¯¾ç­–

### æŠ€è¡“çš„ãƒªã‚¹ã‚¯

#### ãƒªã‚¹ã‚¯1: 3Då¯è¦–åŒ–ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

**å•é¡Œ**: wgpuã®å­¦ç¿’æ›²ç·šã¨æœ€é©åŒ–ã®é›£ã—ã•

**å¯¾ç­–**:

- æ—©æœŸã«ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã‚’ä½œæˆ
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆã‚’ç¶™ç¶šçš„ã«å®Ÿæ–½
- Three.jsã®ä»£æ›¿å®Ÿè£…ã‚’æ¤œè¨ï¼ˆWebAssemblyçµŒç”±ï¼‰

#### ãƒªã‚¹ã‚¯2: ROS2çµ±åˆã®è¤‡é›‘ã•

**å•é¡Œ**: rclrsã®æˆç†Ÿåº¦ã¨ROS2ã®è¤‡é›‘ã•

**å¯¾ç­–**:

- ROS2ã®åŸºæœ¬æ©Ÿèƒ½ã®ã¿ã‚’å®Ÿè£…
- å¿…è¦ã«å¿œã˜ã¦C++ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚’æ¤œè¨
- ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã¨ã®é€£æº

#### ãƒªã‚¹ã‚¯3: æ‹¡å¼µæ©Ÿèƒ½ã‚·ã‚¹ãƒ†ãƒ ã®äº’æ›æ€§

**å•é¡Œ**: æ—¢å­˜ã®æ‹¡å¼µæ©Ÿèƒ½ã¨ã®äº’æ›æ€§

**å¯¾ç­–**:

- æ‹¡å¼µæ©Ÿèƒ½APIã®äº’æ›æ€§ã‚’ç¶­æŒ
- ç§»è¡Œãƒ„ãƒ¼ãƒ«ã®æä¾›
- æ®µéšçš„ãªç§»è¡Œã‚µãƒãƒ¼ãƒˆ

### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒªã‚¹ã‚¯

#### ãƒªã‚¹ã‚¯4: é–‹ç™ºæœŸé–“ã®é•·æœŸåŒ–

**å•é¡Œ**: å®Œå…¨å†ç¾ã«ã¯1-2å¹´ã‹ã‹ã‚‹å¯èƒ½æ€§

**å¯¾ç­–**:

- æ®µéšçš„ãªãƒªãƒªãƒ¼ã‚¹è¨ˆç”»
- MVPï¼ˆæœ€å°é™ã®æ©Ÿèƒ½ï¼‰ã‚’æ—©æœŸã«ãƒªãƒªãƒ¼ã‚¹
- å„ªå…ˆé †ä½ã®æ˜ç¢ºåŒ–

#### ãƒªã‚¹ã‚¯5: ãƒªã‚½ãƒ¼ã‚¹ä¸è¶³

**å•é¡Œ**: å¤§è¦æ¨¡ãªå†å®Ÿè£…ã«ã¯å¤šãã®ãƒªã‚½ãƒ¼ã‚¹ãŒå¿…è¦

**å¯¾ç­–**:

- ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã®æ´»ç”¨
- æ®µéšçš„ãªå®Ÿè£…
- æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã®å†åˆ©ç”¨ï¼ˆå¯èƒ½ãªç¯„å›²ï¼‰

---

## é–‹ç™ºãƒªã‚½ãƒ¼ã‚¹è¦‹ç©ã‚‚ã‚Š

### äººå“¡æ§‹æˆï¼ˆæ¨å¥¨ï¼‰

- **Rusté–‹ç™ºè€…**: 2-3åï¼ˆãƒ•ãƒ«ã‚¿ã‚¤ãƒ ï¼‰
- **ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºè€…**: 1åï¼ˆãƒ‘ãƒ¼ãƒˆã‚¿ã‚¤ãƒ ï¼‰
- **3Dã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ã‚¹é–‹ç™ºè€…**: 1åï¼ˆãƒ‘ãƒ¼ãƒˆã‚¿ã‚¤ãƒ ï¼‰
- **QAã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢**: 1åï¼ˆãƒ‘ãƒ¼ãƒˆã‚¿ã‚¤ãƒ ï¼‰

### é–‹ç™ºæœŸé–“

- **Phase 1-3**: 8-10ãƒ¶æœˆï¼ˆMVPå®Œæˆï¼‰
- **Phase 4-5**: 4-6ãƒ¶æœˆï¼ˆæ©Ÿèƒ½æ‹¡å¼µï¼‰
- **Phase 6-7**: 2-3ãƒ¶æœˆï¼ˆã‚µãƒ¼ãƒãƒ¼ãƒ»ãƒ†ã‚¹ãƒˆï¼‰

**åˆè¨ˆ**: 14-19ãƒ¶æœˆ

### ã‚³ã‚¹ãƒˆè¦‹ç©ã‚‚ã‚Šï¼ˆæ¦‚ç®—ï¼‰

- **äººä»¶è²»**: 14-19äººæœˆ Ã— å˜ä¾¡
- **ã‚¤ãƒ³ãƒ•ãƒ©**: é–‹ç™ºç’°å¢ƒã€CI/CD
- **ãƒ„ãƒ¼ãƒ«**: ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã€ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹

---

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. **æŠ€è¡“æ¤œè¨¼**

   - wgpuãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—ã®ä½œæˆ
   - ROS2çµ±åˆã®æ¤œè¨¼
   - Tauri + Reactã®çµ±åˆãƒ†ã‚¹ãƒˆ

2. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚­ãƒƒã‚¯ã‚ªãƒ•**

   - ãƒãƒ¼ãƒ ç·¨æˆ
   - é–‹ç™ºç’°å¢ƒã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
   - è©³ç´°è¨­è¨ˆã®é–‹å§‹

3. **MVPå®šç¾©**
   - æœ€å°é™ã®æ©Ÿèƒ½ã‚»ãƒƒãƒˆã®å®šç¾©
   - å„ªå…ˆé †ä½ã®æ±ºå®š
   - ãƒã‚¤ãƒ«ã‚¹ãƒˆãƒ¼ãƒ³ã®è¨­å®š

---

## å‚è€ƒè³‡æ–™

- [Tauri Documentation](https://tauri.app/)
- [wgpu Documentation](https://wgpu.rs/)
- [rclrs Documentation](https://github.com/ros2-rust/ros2_rust)
- [Axum Documentation](https://docs.rs/axum/)
- [Lichtblick Current Architecture](./lichtblick-architecture.md)

---

**ä½œæˆè€…**: AI Assistant
**ãƒ¬ãƒ“ãƒ¥ãƒ¼**: è¦ãƒ¬ãƒ“ãƒ¥ãƒ¼
**æ‰¿èª**: æœªæ‰¿èª

# Lichtblick Tauriç§»è¡Œè¨ˆç”»æ›¸ - æ®µéšçš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

**ä½œæˆæ—¥**: 2025-11-30
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0.0
**å¯¾è±¡**: Lichtblick Tauriç§»è¡Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆæ®µéšçš„ç§»è¡Œï¼‰

---

## ğŸ“‹ ç›®æ¬¡

1. [æ¦‚è¦](#æ¦‚è¦)
2. [ç§»è¡Œæˆ¦ç•¥](#ç§»è¡Œæˆ¦ç•¥)
3. [ãƒ•ã‚§ãƒ¼ã‚ºåˆ¥è¨ˆç”»](#ãƒ•ã‚§ãƒ¼ã‚ºåˆ¥è¨ˆç”»)
4. [æŠ€è¡“çš„è€ƒæ…®äº‹é …](#æŠ€è¡“çš„è€ƒæ…®äº‹é …)
5. [ãƒªã‚¹ã‚¯åˆ†æã¨å¯¾ç­–](#ãƒªã‚¹ã‚¯åˆ†æã¨å¯¾ç­–)
6. [æˆåŠŸåŸºæº–](#æˆåŠŸåŸºæº–)

---

## æ¦‚è¦

### ç›®çš„

Lichtblickã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’Electronã‹ã‚‰Tauriã«æ®µéšçš„ã«ç§»è¡Œã—ã€ä»¥ä¸‹ã®ç›®æ¨™ã‚’é”æˆã™ã‚‹ï¼š

- **Phase 1**: React + Tauriã§ã®å‹•ä½œæ¤œè¨¼ï¼ˆç¾åœ¨ã®ãƒ•ã‚§ãƒ¼ã‚ºï¼‰
- **Phase 2**: Rustãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã®æ®µéšçš„å°å…¥
- **Phase 3**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®Rustç§»è¡Œï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

### è¨ˆç”»å¤‰æ›´ã®èƒŒæ™¯

å¾“æ¥ã®è¨ˆç”»ï¼ˆ`rust-complete-rewrite-plan.md`ï¼‰ã¯ã€Œå®Œå…¨Rustæ›¸ãæ›ãˆã€ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã—ãŸãŒã€ä»¥ä¸‹ã®ç†ç”±ã‹ã‚‰æ®µéšçš„ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã«å¤‰æ›´ï¼š

1. **ãƒªã‚¹ã‚¯è»½æ¸›**: ä¸€åº¦ã«å…¨ä½“ã‚’æ›¸ãæ›ãˆã‚‹ã‚ˆã‚Šã€å‹•ä½œç¢ºèªã—ãªãŒã‚‰é€²ã‚ã‚‹æ–¹ãŒå®‰å…¨
2. **é–‹ç™ºåŠ¹ç‡**: æ—¢å­˜ã®Reactã‚³ãƒ¼ãƒ‰ãƒ™ãƒ¼ã‚¹ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã§é–‹ç™ºæœŸé–“ã‚’çŸ­ç¸®
3. **æ¤œè¨¼å„ªå…ˆ**: ã¾ãšTauriç’°å¢ƒã§ã®å‹•ä½œã‚’ç¢ºèªã—ã€å•é¡Œç‚¹ã‚’æ—©æœŸç™ºè¦‹

### ç¾åœ¨ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
ç¾åœ¨ã®Lichtblick (Electronç‰ˆ)
â”œâ”€â”€ ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰: React + TypeScript
â”‚   â”œâ”€â”€ packages/suite-base/     # ã‚³ã‚¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”œâ”€â”€ packages/suite-web/      # Webç‰ˆ
â”‚   â””â”€â”€ packages/suite-desktop/  # Desktopç‰ˆï¼ˆElectronå›ºæœ‰ï¼‰
â”œâ”€â”€ ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—: Electron
â”‚   â”œâ”€â”€ main process (Node.js)
â”‚   â””â”€â”€ renderer process (React)
â””â”€â”€ ãƒ‡ãƒ¼ã‚¿å‡¦ç†: TypeScript/JavaScript
```

---

## ç§»è¡Œæˆ¦ç•¥

### 3ãƒ•ã‚§ãƒ¼ã‚ºç§»è¡Œã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Phase 1: React + Tauri å‹•ä½œæ¤œè¨¼ (ç¾åœ¨)                       â”‚
â”‚ ãƒ»æ—¢å­˜Reactã‚³ãƒ¼ãƒ‰ã‚’ãã®ã¾ã¾ä½¿ç”¨                              â”‚
â”‚ ãƒ»Electron APIã‚’Tauri APIã«ç½®æ›                             â”‚
â”‚ ãƒ»åŸºæœ¬æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Phase 2: Rustãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å°å…¥                                â”‚
â”‚ ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãªå‡¦ç†ã‚’Rustã«ç§»è¡Œ                â”‚
â”‚ ãƒ»ãƒ‡ãƒ¼ã‚¿å‡¦ç†ï¼ˆMCAPã€ROS2ç­‰ï¼‰ã‚’Rustã§å®Ÿè£…                     â”‚
â”‚ ãƒ»Tauriã‚³ãƒãƒ³ãƒ‰ã«ã‚ˆã‚‹ãƒ•ãƒ­ãƒ³ãƒˆãƒ»ãƒãƒƒã‚¯é€£æº                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Phase 3: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å¼·åŒ–ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰                    â”‚
â”‚ ãƒ»3Då¯è¦–åŒ–ã®wgpuç§»è¡Œ                                         â”‚
â”‚ ãƒ»ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®Rustç§»è¡Œï¼ˆegui/Leptosï¼‰                    â”‚
â”‚ ãƒ»å®Œå…¨ãƒã‚¤ãƒ†ã‚£ãƒ–åŒ–                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ãƒ•ã‚§ãƒ¼ã‚ºåˆ¥è¨ˆç”»

## Phase 1: React + Tauri å‹•ä½œæ¤œè¨¼

**æœŸé–“**: 2-4é€±é–“
**ç›®æ¨™**: æ—¢å­˜ã®React UIã‚’Tauriç’°å¢ƒã§å‹•ä½œã•ã›ã‚‹

### 1.1 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ è¨­è¨ˆ

```
shinsei/
â”œâ”€â”€ src-tauri/                    # Tauri Rustãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
â”‚   â”œâ”€â”€ Cargo.toml
â”‚   â”œâ”€â”€ tauri.conf.json
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ main.rs
â”‚       â”œâ”€â”€ commands/             # Tauriã‚³ãƒãƒ³ãƒ‰
â”‚       â”‚   â”œâ”€â”€ mod.rs
â”‚       â”‚   â”œâ”€â”€ file_system.rs    # ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ
â”‚       â”‚   â””â”€â”€ app_info.rs       # ã‚¢ãƒ—ãƒªæƒ…å ±
â”‚       â””â”€â”€ lib.rs
â”œâ”€â”€ src/                          # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ï¼ˆReactï¼‰
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ main.tsx
â”‚   â”œâ”€â”€ App.tsx
â”‚   â””â”€â”€ components/
â”œâ”€â”€ lichtblick/                   # æ—¢å­˜lichtblickã‚½ãƒ¼ã‚¹ï¼ˆå‚ç…§ï¼‰
â”‚   â””â”€â”€ packages/
â”‚       â”œâ”€â”€ suite-base/           # ã‚³ã‚¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆå†åˆ©ç”¨ï¼‰
â”‚       â””â”€â”€ suite-web/            # Webç‰ˆï¼ˆãƒ™ãƒ¼ã‚¹ï¼‰
â”œâ”€â”€ package.json
â”œâ”€â”€ vite.config.ts                # Viteãƒ“ãƒ«ãƒ‰è¨­å®š
â””â”€â”€ tsconfig.json
```

### 1.2 å®Ÿè£…ã‚¿ã‚¹ã‚¯

#### Step 1.2.1: Tauri + React ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–ï¼ˆ1-2æ—¥ï¼‰

- [ ] Tauri v2ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
- [ ] Vite + React + TypeScriptç’°å¢ƒæ§‹ç¯‰
- [ ] åŸºæœ¬çš„ãªã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è¡¨ç¤ºã®ç¢ºèª

**ã‚¿ã‚¹ã‚¯è©³ç´°**:

```bash
# æ–°ã—ã„Tauri v2ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
cd shinsei
bunx create-tauri-app . --template react-ts

# ä¾å­˜é–¢ä¿‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
bun install

# é–‹ç™ºã‚µãƒ¼ãƒãƒ¼èµ·å‹•ãƒ†ã‚¹ãƒˆ
bun run tauri dev
```

#### Step 1.2.2: Lichtblickä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®çµ±åˆï¼ˆ3-5æ—¥ï¼‰

- [ ] `@lichtblick/suite-base`ã®ä¾å­˜è§£æ±º
- [ ] Webpackã‹ã‚‰ã®è¨­å®šç§»è¡Œï¼ˆViteï¼‰
- [ ] å¿…è¦ãªãƒãƒªãƒ•ã‚£ãƒ«ã®è¨­å®š

**package.jsonä¾å­˜é–¢ä¿‚ã®è¿½åŠ **:

```json
{
  "dependencies": {
    "@lichtblick/suite-base": "link:./lichtblick/packages/suite-base",
    "@lichtblick/log": "link:./lichtblick/packages/log",
    "@lichtblick/hooks": "link:./lichtblick/packages/hooks",
    "@lichtblick/message-path": "link:./lichtblick/packages/message-path",
    "react": "18.3.1",
    "react-dom": "18.3.1",
    "@mui/material": "7.2.0",
    "three": "0.156.1"
  }
}
```

#### Step 1.2.3: Electron APIç½®æ›å±¤ã®å®Ÿè£…ï¼ˆ5-7æ—¥ï¼‰

- [ ] ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ APIç½®æ›
- [ ] ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦APIç½®æ›
- [ ] ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒ»ãƒ€ã‚¤ã‚¢ãƒ­ã‚°APIç½®æ›
- [ ] IPCé€šä¿¡ã®ç½®æ›

**Electron â†’ Tauri API ãƒãƒƒãƒ”ãƒ³ã‚°**:

| Electron API               | Tauri API                   | å‚™è€ƒ             |
| -------------------------- | --------------------------- | ---------------- |
| `ipcRenderer.invoke()`     | `invoke()`                  | Tauriã‚³ãƒãƒ³ãƒ‰    |
| `dialog.showOpenDialog()`  | `@tauri-apps/plugin-dialog` | ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ     |
| `fs.readFile()`            | `@tauri-apps/plugin-fs`     | ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ |
| `shell.openExternal()`     | `@tauri-apps/plugin-shell`  | å¤–éƒ¨ãƒªãƒ³ã‚¯       |
| `app.getPath()`            | `@tauri-apps/api/path`      | ãƒ‘ã‚¹å–å¾—         |
| `Menu.buildFromTemplate()` | Tauri Menu API              | ãƒ¡ãƒ‹ãƒ¥ãƒ¼         |

**ç½®æ›ã‚³ãƒ¼ãƒ‰ä¾‹**:

```typescript
// src/services/TauriBridge.ts
import { invoke } from "@tauri-apps/api/core";
import { open, save } from "@tauri-apps/plugin-dialog";
import { readFile, writeFile } from "@tauri-apps/plugin-fs";

export const TauriBridge = {
  // ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°
  async showOpenDialog(options: OpenDialogOptions) {
    return await open({
      multiple: options.multiple ?? false,
      filters: options.filters,
      directory: options.directory ?? false,
    });
  },

  // ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
  async readFile(path: string): Promise<Uint8Array> {
    return await readFile(path);
  },

  // Rustå´ã®å‡¦ç†ã‚’å‘¼ã³å‡ºã—
  async invoke<T>(cmd: string, args?: Record<string, unknown>): Promise<T> {
    return await invoke<T>(cmd, args);
  },
};
```

#### Step 1.2.4: ã‚³ã‚¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ç§»æ¤ï¼ˆ5-7æ—¥ï¼‰

- [ ] ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆã®ä½œæˆ
- [ ] ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼éšå±¤ã®è¨­å®š
- [ ] ãƒ†ãƒ¼ãƒãƒ»ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°ã®çµ±åˆ
- [ ] åŸºæœ¬ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®å‹•ä½œç¢ºèª

**App.tsxæ§‹é€ **:

```typescript
// src/App.tsx
import { StrictMode } from 'react';
import { ThemeProvider } from '@mui/material/styles';
import { CssBaseline } from '@mui/material';
import { theme } from '@lichtblick/theme';
import { App as LichtblickApp } from '@lichtblick/suite-base';
import { TauriDataSourceFactory } from './services/TauriDataSourceFactory';

export function App() {
  return (
    <StrictMode>
      <ThemeProvider theme={theme}>
        <CssBaseline />
        <LichtblickApp
          dataSourceFactories={[new TauriDataSourceFactory()]}
          // ...ä»–ã®ãƒ—ãƒ­ãƒã‚¤ãƒ€ãƒ¼è¨­å®š
        />
      </ThemeProvider>
    </StrictMode>
  );
}
```

### 1.3 æ¤œè¨¼é …ç›®

#### åŸºæœ¬æ©Ÿèƒ½æ¤œè¨¼ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

| ã‚«ãƒ†ã‚´ãƒª         | é …ç›®                   | çŠ¶æ…‹ | å‚™è€ƒ |
| ---------------- | ---------------------- | ---- | ---- |
| **èµ·å‹•**         | ã‚¢ãƒ—ãƒªãŒèµ·å‹•ã™ã‚‹       | â¬œ   |      |
|                  | åˆæœŸç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã‚‹   | â¬œ   |      |
|                  | ãƒ¡ãƒ‹ãƒ¥ãƒ¼ãƒãƒ¼ãŒæ©Ÿèƒ½ã™ã‚‹ | â¬œ   |      |
| **ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ** | ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚° | â¬œ   |      |
|                  | MCAPãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã‘ã‚‹   | â¬œ   |      |
|                  | ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿æˆåŠŸ   | â¬œ   |      |
| **UIè¡¨ç¤º**       | ãƒ‘ãƒãƒ«ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆè¡¨ç¤º   | â¬œ   |      |
|                  | ãƒ‘ãƒãƒ«ã®è¿½åŠ ãƒ»å‰Šé™¤     | â¬œ   |      |
|                  | ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®ä¿å­˜ãƒ»èª­è¾¼ | â¬œ   |      |
| **ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º**   | ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³è¡¨ç¤º       | â¬œ   |      |
|                  | ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä¸€è¦§è¡¨ç¤º     | â¬œ   |      |
|                  | å†ç”Ÿãƒ»ä¸€æ™‚åœæ­¢         | â¬œ   |      |
| **3Då¯è¦–åŒ–**     | 3Dãƒ‘ãƒãƒ«è¡¨ç¤º           | â¬œ   |      |
|                  | ç‚¹ç¾¤ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º         | â¬œ   |      |
|                  | ã‚«ãƒ¡ãƒ©æ“ä½œ             | â¬œ   |      |
| **ãã®ä»–ãƒ‘ãƒãƒ«** | Plotãƒ‘ãƒãƒ«             | â¬œ   |      |
|                  | Imageãƒ‘ãƒãƒ«            | â¬œ   |      |
|                  | RawMessagesãƒ‘ãƒãƒ«      | â¬œ   |      |

### 1.4 æƒ³å®šã•ã‚Œã‚‹èª²é¡Œã¨å¯¾ç­–

#### èª²é¡Œ1: Node.jsä¾å­˜ã®å‡¦ç†

**å•é¡Œ**: Lichtblickã®ä¸€éƒ¨æ©Ÿèƒ½ãŒNode.jså›ºæœ‰ã®APIã«ä¾å­˜

**å¯¾ç­–**:

- Webworkerã§ä»£æ›¿å¯èƒ½ãªã‚‚ã®ã¯Webworkerã«ç§»è¡Œ
- Tauri Rustã‚³ãƒãƒ³ãƒ‰ã§ä»£æ›¿
- å¿…è¦ã«å¿œã˜ã¦Polyfillã‚’é©ç”¨

```typescript
// Nodeãƒãƒƒãƒ•ã‚¡ã®ç½®æ›ä¾‹
// Before (Node.js)
const buffer = Buffer.from(data);

// After (Web API)
const buffer = new Uint8Array(data);
```

#### èª²é¡Œ2: Electronãƒ—ãƒªãƒ­ãƒ¼ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆ

**å•é¡Œ**: `suite-desktop`ãŒElectronã®ãƒ—ãƒªãƒ­ãƒ¼ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ä¾å­˜

**å¯¾ç­–**:

- Tauriã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚·ã‚¹ãƒ†ãƒ ã§åŒç­‰æ©Ÿèƒ½ã‚’å®Ÿè£…
- `window.__TAURI__`ã‚’ä½¿ç”¨ã—ãŸã‚°ãƒ­ãƒ¼ãƒãƒ«APIæä¾›

```rust
// src-tauri/src/main.rs
#[tauri::command]
fn get_app_info() -> Result<AppInfo, String> {
    Ok(AppInfo {
        version: env!("CARGO_PKG_VERSION").to_string(),
        name: "Lichtblick (Tauri)".to_string(),
    })
}
```

#### èª²é¡Œ3: WebSocket/ROS2æ¥ç¶š

**å•é¡Œ**: Tauriç’°å¢ƒã§ã®WebSocketæ¥ç¶šã®æŒ™å‹•ç¢ºèªãŒå¿…è¦

**å¯¾ç­–**:

- CSPè¨­å®šã®èª¿æ•´
- Tauriãƒ—ãƒ©ã‚°ã‚¤ãƒ³ï¼ˆ`tauri-plugin-http`ï¼‰ã®æ´»ç”¨
- å¿…è¦ã«å¿œã˜ã¦Rustå´ã§WebSocketå‡¦ç†

---

## Phase 2: Rustãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰å°å…¥ï¼ˆPhase 1å®Œäº†å¾Œï¼‰

**æœŸé–“**: 2-3ãƒ¶æœˆ
**ç›®æ¨™**: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãªå‡¦ç†ã‚’Rustã«ç§»è¡Œ

### 2.1 å„ªå…ˆç§»è¡Œå¯¾è±¡

1. **MCAPãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿**

   - å¤§è¦æ¨¡ãƒ•ã‚¡ã‚¤ãƒ«ã®é«˜é€Ÿèª­ã¿è¾¼ã¿
   - ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ã®æ”¹å–„

2. **ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³**

   - ROS2ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®é«˜é€Ÿãƒ‘ãƒ¼ã‚¹
   - CDR/JSONå¤‰æ›

3. **ç‚¹ç¾¤å‡¦ç†**
   - å¤§é‡ç‚¹ã®ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
   - åº§æ¨™å¤‰æ›

### 2.2 ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    React Frontend                           â”‚
â”‚  â”œâ”€â”€ UI Components (æ—¢å­˜)                                   â”‚
â”‚  â”œâ”€â”€ Three.js 3D Rendering (æ—¢å­˜)                           â”‚
â”‚  â””â”€â”€ Tauri invoke() â†“â†‘                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Tauri Commands                           â”‚
â”‚  â”œâ”€â”€ read_mcap_file() â†’ MCAPãƒ‡ãƒ¼ã‚¿                          â”‚
â”‚  â”œâ”€â”€ process_pointcloud() â†’ å‡¦ç†æ¸ˆã¿ç‚¹ç¾¤                    â”‚
â”‚  â””â”€â”€ connect_ros2() â†’ ROS2æ¥ç¶š                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Rust Backend                             â”‚
â”‚  â”œâ”€â”€ mcap-rs: MCAPãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†                              â”‚
â”‚  â”œâ”€â”€ rclrs: ROS2æ¥ç¶š                                        â”‚
â”‚  â””â”€â”€ tokio: éåŒæœŸå‡¦ç†                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Phase 3: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰å¼·åŒ–ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰

**æœŸé–“**: 3-6ãƒ¶æœˆ
**ç›®æ¨™**: å®Œå…¨ãƒã‚¤ãƒ†ã‚£ãƒ–åŒ–ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰

### 3.1 æ¤œè¨é …ç›®

- [ ] wgpuã«ã‚ˆã‚‹3Då¯è¦–åŒ–ã®é«˜é€ŸåŒ–
- [ ] eguiã¾ãŸã¯Leptosã¸ã®UIç§»è¡Œ
- [ ] WebAssemblyæœ€é©åŒ–

### 3.2 åˆ¤æ–­åŸºæº–

Phase 2å®Œäº†å¾Œã€ä»¥ä¸‹ã‚’è©•ä¾¡ã—ã¦åˆ¤æ–­ï¼š

- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¦ä»¶ã®å……è¶³åº¦
- ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
- é–‹ç™ºãƒªã‚½ãƒ¼ã‚¹ã®çŠ¶æ³

---

## æŠ€è¡“çš„è€ƒæ…®äº‹é …

### é–‹ç™ºç’°å¢ƒè¦ä»¶

```
å¿…é ˆ:
â”œâ”€â”€ Bun 1.0+
â”œâ”€â”€ Rust 1.75+
â”œâ”€â”€ Tauri CLI 2.0+
â””â”€â”€ (Node.js 20+ - ä¸€éƒ¨ãƒ„ãƒ¼ãƒ«ã§å¿…è¦ãªå ´åˆ)

æ¨å¥¨:
â”œâ”€â”€ VS Code
â”œâ”€â”€ rust-analyzer
â””â”€â”€ Tauri extension
```

### Tauri v2 è¨­å®š

```json
// src-tauri/tauri.conf.json
{
  "$schema": "https://schema.tauri.app/config/2",
  "productName": "Lichtblick",
  "version": "1.0.0",
  "identifier": "com.lichtblick.app",
  "build": {
    "beforeDevCommand": "bun run dev",
    "devUrl": "http://localhost:5173",
    "beforeBuildCommand": "bun run build",
    "frontendDist": "../dist"
  },
  "app": {
    "withGlobalTauri": true,
    "windows": [
      {
        "title": "Lichtblick",
        "width": 1400,
        "height": 900,
        "resizable": true,
        "fullscreen": false
      }
    ],
    "security": {
      "csp": "default-src 'self'; img-src 'self' data: blob:; script-src 'self'; style-src 'self' 'unsafe-inline'"
    }
  },
  "plugins": {
    "dialog": {},
    "fs": {
      "scope": ["$APPDATA", "$DOCUMENT", "$HOME"]
    },
    "shell": {
      "open": true
    }
  }
}
```

### Viteè¨­å®š

```typescript
// vite.config.ts
import { defineConfig } from "vite";
import react from "@vitejs/plugin-react";
import { resolve } from "path";

export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      "@lichtblick/suite-base": resolve(__dirname, "./lichtblick/packages/suite-base/src"),
      "@lichtblick/log": resolve(__dirname, "./lichtblick/packages/log/src"),
      // ä»–ã®ã‚¨ã‚¤ãƒªã‚¢ã‚¹
    },
  },
  build: {
    target: "esnext",
    minify: "esbuild",
  },
  // Tauriã¨ã®é€£æº
  clearScreen: false,
  server: {
    port: 5173,
    strictPort: true,
  },
});
```

---

## ãƒªã‚¹ã‚¯åˆ†æã¨å¯¾ç­–

### Phase 1 ã®ãƒªã‚¹ã‚¯

| ãƒªã‚¹ã‚¯               | å½±éŸ¿åº¦ | ç™ºç”Ÿç¢ºç‡ | å¯¾ç­–                                          |
| -------------------- | ------ | -------- | --------------------------------------------- |
| ä¾å­˜é–¢ä¿‚ã®è§£æ±ºå›°é›£   | é«˜     | ä¸­       | ãƒ¯ãƒ¼ã‚¯ã‚¹ãƒšãƒ¼ã‚¹ãƒªãƒ³ã‚¯ã‚’æ´»ç”¨ã€æ®µéšçš„ã«ä¾å­˜è¿½åŠ   |
| Electron APIäº’æ›æ€§   | é«˜     | é«˜       | æŠ½è±¡åŒ–å±¤ã§å¸åã€Tauriãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ´»ç”¨           |
| 3Dæç”»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ | ä¸­     | ä½       | Three.jsã¯ãã®ã¾ã¾å‹•ä½œã™ã‚‹ã¯ãšã€CSPèª¿æ•´ã§å¯¾å¿œ |
| WebSocketæ¥ç¶šå•é¡Œ    | ä¸­     | ä¸­       | Tauri CSPè¨­å®šã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³æ´»ç”¨                 |
| ãƒ“ãƒ«ãƒ‰æ™‚é–“å¢—åŠ        | ä½     | ä¸­       | Viteã®æ´»ç”¨ã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœ€é©åŒ–                  |

### æ’¤é€€åŸºæº–

Phase 1ã§ä»¥ä¸‹ã®å•é¡ŒãŒè§£æ±ºä¸å¯èƒ½ãªå ´åˆã€è¨ˆç”»ã‚’å†æ¤œè¨ï¼š

1. åŸºæœ¬çš„ãªUIè¡¨ç¤ºãŒã§ããªã„
2. ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ãŒå‹•ä½œã—ãªã„
3. 3Dæç”»ãŒå…¨ãæ©Ÿèƒ½ã—ãªã„
4. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒElectronç‰ˆã‚ˆã‚Šè‘—ã—ãåŠ£åŒ–

---

## æˆåŠŸåŸºæº–

### Phase 1 å®Œäº†åŸºæº–

1. **æ©Ÿèƒ½è¦ä»¶**

   - [ ] MCAPãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã„ã¦ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã‚’è¡¨ç¤ºã§ãã‚‹
   - [ ] åŸºæœ¬çš„ãªãƒ‘ãƒãƒ«ï¼ˆRawMessages, Plot, Imageï¼‰ãŒå‹•ä½œã™ã‚‹
   - [ ] 3Dãƒ‘ãƒãƒ«ã§ç‚¹ç¾¤ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã§ãã‚‹
   - [ ] ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®ä¿å­˜ãƒ»èª­è¾¼ãŒã§ãã‚‹

2. **éæ©Ÿèƒ½è¦ä»¶**

   - [ ] èµ·å‹•æ™‚é–“: 5ç§’ä»¥å†…
   - [ ] ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡: Electronç‰ˆã¨åŒç­‰ä»¥ä¸‹
   - [ ] UIã®å¿œç­”æ€§: é…å»¶ãªã—

3. **å“è³ªè¦ä»¶**
   - [ ] ã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãªã30åˆ†ä»¥ä¸Šå‹•ä½œ
   - [ ] ä¸»è¦æ©Ÿèƒ½ã®E2Eãƒ†ã‚¹ãƒˆãŒãƒ‘ã‚¹

---

## ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

### Phase 1 è©³ç´°ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

```
Week 1:
â”œâ”€â”€ Day 1-2: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–ã€Tauri + Vite + Reactè¨­å®š
â””â”€â”€ Day 3-5: Lichtblickä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®çµ±åˆé–‹å§‹

Week 2:
â”œâ”€â”€ Day 6-8: ä¾å­˜è§£æ±ºç¶™ç¶šã€ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼ä¿®æ­£
â””â”€â”€ Day 9-10: Electron APIç½®æ›å±¤ã®è¨­è¨ˆãƒ»å®Ÿè£…é–‹å§‹

Week 3:
â”œâ”€â”€ Day 11-13: ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œAPIç½®æ›
â””â”€â”€ Day 14-15: ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ»ãƒ¡ãƒ‹ãƒ¥ãƒ¼APIç½®æ›

Week 4:
â”œâ”€â”€ Day 16-18: ã‚³ã‚¢ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®çµ±åˆãƒ†ã‚¹ãƒˆ
â”œâ”€â”€ Day 19-20: æ¤œè¨¼ã€ãƒã‚°ä¿®æ­£
â””â”€â”€ Day 21: Phase 1å®Œäº†åˆ¤å®šã€æ¬¡ãƒ•ã‚§ãƒ¼ã‚ºè¨ˆç”»
```

---

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### å³åº§ã«å®Ÿè¡Œã™ã¹ãã‚¿ã‚¹ã‚¯

1. **ç’°å¢ƒæº–å‚™**

   ```bash
   # Bun ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆæœªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®å ´åˆï¼‰
   curl -fsSL https://bun.sh/install | bash

   # Tauri CLI ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
   bun add -g @tauri-apps/cli@next

   # Rustç’°å¢ƒç¢ºèª
   rustc --version
   cargo --version
   ```

2. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–**

   ```bash
   cd shinsei
   # æ—¢å­˜ã®Leptosè¨­å®šã‚’ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—
   mv src src-leptos-backup
   mv Cargo.toml Cargo.toml.leptos

   # React + Tauriãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
   bunx create-tauri-app . --template react-ts
   ```

3. **ä¾å­˜é–¢ä¿‚ã®èª¿æŸ»**
   - `@lichtblick/suite-base`ã®ä¾å­˜ä¸€è¦§ç¢ºèª
   - Electronå›ºæœ‰APIã®ä½¿ç”¨ç®‡æ‰€ç‰¹å®š
   - ç§»æ¤ã«å¿…è¦ãªå¤‰æ›´é‡ã®è¦‹ç©ã‚‚ã‚Š

---

## å‚è€ƒè³‡æ–™

- [Tauri v2 Documentation](https://v2.tauri.app/)
- [Tauri Plugins](https://v2.tauri.app/plugin/)
- [Vite Documentation](https://vitejs.dev/)
- [Electron to Tauri Migration Guide](https://v2.tauri.app/start/migrate/from-electron/)
- æ—¢å­˜è¨ˆç”»æ›¸: `rust-complete-rewrite-plan.md`

---

## å¤‰æ›´å±¥æ­´

| æ—¥ä»˜       | ãƒãƒ¼ã‚¸ãƒ§ãƒ³ | å¤‰æ›´å†…å®¹                               |
| ---------- | ---------- | -------------------------------------- |
| 2025-11-30 | 1.0.0      | åˆç‰ˆä½œæˆ - React + Tauriæ®µéšçš„ç§»è¡Œè¨ˆç”» |

---

**ä½œæˆè€…**: AI Assistant
**ãƒ¬ãƒ“ãƒ¥ãƒ¼**: è¦ãƒ¬ãƒ“ãƒ¥ãƒ¼
**æ‰¿èª**: æœªæ‰¿èª
